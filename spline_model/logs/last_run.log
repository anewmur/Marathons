2025-12-17 15:48:55 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:50:38 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:51:26 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:51:33 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:51:57 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:52:09 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:52:28 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:53:10 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:53:10 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 15:53:10 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 15:53:10 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 15:53:11 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 15:53:11 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 15:53:11 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.24s
2025-12-17 15:53:11 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 15:53:11 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 15:53:11 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 15:53:11 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 15:53:11 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 15:53:11 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.257s, null_city=4304
2025-12-17 15:53:11 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.051s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 15:53:11 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.009s, na_birth_year=0, unique_birth_years=73
2025-12-17 15:53:11 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.214s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 15:53:11 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.072s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 15:53:12 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.901s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 15:53:27 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:53:27 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 15:53:27 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 15:53:27 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 15:53:27 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 15:53:27 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 15:53:27 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 15:53:27 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 15:53:27 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 15:53:27 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 15:53:27 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 15:53:27 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 15:53:27 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.251s, null_city=4304
2025-12-17 15:53:27 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.044s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 15:53:27 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 15:53:28 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.154s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 15:53:28 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.083s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 15:53:29 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.857s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 15:54:13 | INFO     | root                 | === Логирование включено ===
2025-12-17 15:54:13 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 15:54:13 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 15:54:13 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 15:54:13 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 15:54:13 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 15:54:13 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 15:54:13 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 15:54:13 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 15:54:13 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 15:54:13 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 15:54:13 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 15:54:14 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.249s, null_city=4304
2025-12-17 15:54:14 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.036s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 15:54:14 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 15:54:14 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.210s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 15:54:14 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.075s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 15:54:15 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.868s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:03:45 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:05:15 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:06:16 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:06:16 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:06:16 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:06:16 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:06:16 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:06:16 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:06:16 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:06:16 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:06:16 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:06:16 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:06:16 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:06:16 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:06:16 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.250s, null_city=4304
2025-12-17 16:06:16 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.040s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:06:16 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:06:16 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.150s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:06:16 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.064s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:06:17 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.856s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:06:30 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:06:30 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:06:30 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:06:30 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:06:30 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:06:30 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:06:30 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.09s
2025-12-17 16:06:30 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:06:30 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:06:30 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.03s
2025-12-17 16:06:30 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:06:30 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:06:30 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.249s, null_city=4304
2025-12-17 16:06:30 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.052s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:06:30 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.012s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:06:30 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.159s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:06:30 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.093s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:06:33 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 3.216s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:08:56 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:08:56 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:08:56 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:08:56 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:08:56 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:08:56 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:08:56 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.09s
2025-12-17 16:08:56 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:08:56 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:08:56 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:08:56 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:08:56 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:08:56 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.291s, null_city=4304
2025-12-17 16:08:56 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.066s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:08:56 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.016s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:08:57 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.219s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:08:57 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.097s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:09:00 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 3.162s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:11:35 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:11:35 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:11:35 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:11:35 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:11:35 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:11:35 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:11:35 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.09s
2025-12-17 16:11:35 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:11:35 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:11:35 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:11:35 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:11:35 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.012s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:11:35 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.273s, null_city=4304
2025-12-17 16:11:35 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.048s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:11:35 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.009s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:11:36 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.204s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:11:36 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.143s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:11:37 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 1.123s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:12:18 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 4.318s)
2025-12-17 16:12:18 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.035s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:12:18 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.058s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:12:18 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.032s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:12:18 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:12:53 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:12:53 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:12:53 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:12:53 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:12:53 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:12:53 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:12:53 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-17 16:12:53 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:12:53 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:12:53 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:12:53 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:12:53 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.008s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:12:54 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.255s, null_city=4304
2025-12-17 16:12:54 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.054s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:12:54 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.009s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:12:54 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.189s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:12:54 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.106s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 1.025s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:12:55 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.006s)
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.052s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.062s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.032s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:12:55 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:12:55 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.182s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.028s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:12:55 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.122s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:12:55 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.022s, age_center=35.0, age_scale=10.0
2025-12-17 16:12:56 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.181s
2025-12-17 16:12:56 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.19s
2025-12-17 16:12:56 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:12:56 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.44s, groups=10
2025-12-17 16:12:56 | INFO     | trace_reference_builder | Trace references saved: outputs\trace_references.xlsx, rows=10
2025-12-17 16:12:56 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:12:56 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:12:56 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:12:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:12:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:12:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:12:57 | INFO     | age_reference_builder | Age references saved: outputs\age_references.xlsx, rows=334
2025-12-17 16:12:57 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.46s, races=5
2025-12-17 16:12:57 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.06s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:16:06 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:16:06 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:16:06 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:16:06 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:16:06 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:16:06 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:16:06 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-17 16:16:06 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:16:06 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:16:06 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:16:06 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:16:06 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:16:06 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.290s, null_city=4304
2025-12-17 16:16:07 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.055s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:16:07 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:16:07 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.252s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:16:07 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.105s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.863s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:16:08 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.047s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.057s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.032s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:16:08 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:16:08 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.175s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:16:08 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.107s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.020s, age_center=35.0, age_scale=10.0
2025-12-17 16:16:08 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.085s
2025-12-17 16:16:08 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.09s
2025-12-17 16:16:09 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:16:09 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.34s, groups=10
2025-12-17 16:17:35 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:17:35 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:17:35 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:17:35 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:17:35 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:17:35 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:17:35 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.09s
2025-12-17 16:17:35 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:17:35 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:17:35 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:17:35 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:17:35 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.000s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:17:35 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.270s, null_city=4304
2025-12-17 16:17:35 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.049s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:17:35 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:17:35 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.148s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:17:35 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.086s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:17:36 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.876s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:17:36 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 16:17:36 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:17:36 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:17:36 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.033s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:17:36 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:17:37 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:17:37 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:17:37 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:17:37 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.167s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:17:37 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:17:37 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:17:37 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.116s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:17:37 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0
2025-12-17 16:17:37 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.939s
2025-12-17 16:17:37 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.94s
2025-12-17 16:17:37 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:17:37 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.41s, groups=10
2025-12-17 16:17:37 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:17:37 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:17:37 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:17:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:17:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:17:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:17:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:17:38 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:17:38 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.48s, races=5
2025-12-17 16:17:38 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.06s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:20:10 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:20:10 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:20:10 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:20:10 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:20:10 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:20:10 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:20:10 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:20:10 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:20:10 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:20:10 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:20:10 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:20:10 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:20:10 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:20:10 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.243s, null_city=4304
2025-12-17 16:20:10 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.039s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:20:10 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:20:10 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.137s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:20:10 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.070s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.852s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:20:11 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.004s)
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.042s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.048s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:20:11 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:20:11 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.143s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:20:11 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.102s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.018s, age_center=35.0, age_scale=10.0
2025-12-17 16:20:11 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.799s
2025-12-17 16:20:11 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.80s
2025-12-17 16:20:12 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:20:12 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.41s, groups=10
2025-12-17 16:20:12 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:20:12 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:20:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:20:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:20:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:20:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:20:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:20:13 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:20:13 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.43s, races=5
2025-12-17 16:20:13 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:20:57 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:20:57 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:20:57 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:20:57 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:20:57 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:20:57 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:20:57 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:20:57 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:20:57 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:20:57 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:20:57 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:20:57 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:20:57 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:20:57 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.247s, null_city=4304
2025-12-17 16:20:57 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.036s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:20:57 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:20:57 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.137s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:20:57 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.061s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:20:58 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.849s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:20:58 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 16:20:58 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:20:58 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:20:58 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.028s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:20:58 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:20:59 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:20:59 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:20:59 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:20:59 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.157s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:20:59 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.022s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:20:59 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:20:59 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.119s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:20:59 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.023s, age_center=35.0, age_scale=10.0
2025-12-17 16:20:59 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.817s
2025-12-17 16:20:59 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.82s
2025-12-17 16:20:59 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:20:59 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.35s, groups=10
2025-12-17 16:20:59 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:20:59 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:20:59 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:21:00 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:21:00 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.43s, races=5
2025-12-17 16:21:00 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.06s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:21:49 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:21:49 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:21:49 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:21:49 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:21:49 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:21:49 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:21:49 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:21:49 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.08s
2025-12-17 16:21:49 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:21:49 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:21:49 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:21:49 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:21:49 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:21:49 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.255s, null_city=4304
2025-12-17 16:21:49 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.052s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:21:49 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:21:49 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.155s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:21:49 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.094s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:21:50 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.875s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:21:50 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.023s)
2025-12-17 16:21:50 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.038s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:21:50 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:21:50 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.048s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:21:50 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:21:51 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:21:51 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:21:51 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:21:51 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.217s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:21:51 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.020s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:21:51 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:21:51 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.140s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:21:51 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.016s, age_center=35.0, age_scale=10.0
2025-12-17 16:21:51 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.059s
2025-12-17 16:21:51 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.06s
2025-12-17 16:21:51 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:21:51 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.36s, groups=10
2025-12-17 16:21:52 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:21:52 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:21:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:21:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:21:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:21:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:21:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:21:52 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:21:52 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.66s, races=5
2025-12-17 16:21:52 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.04s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:24:09 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:24:09 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:24:09 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:24:09 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:24:09 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:24:09 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:24:09 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:24:09 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-17 16:24:09 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:24:09 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:24:09 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:24:09 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:24:09 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:24:10 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.251s, null_city=4304
2025-12-17 16:24:10 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.037s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:24:10 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:24:10 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.156s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:24:10 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.069s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.855s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:24:11 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.044s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.052s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:24:11 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:24:11 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.166s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:24:11 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.116s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0
2025-12-17 16:24:11 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.859s
2025-12-17 16:24:11 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.86s
2025-12-17 16:24:12 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:24:12 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.39s, groups=10
2025-12-17 16:24:12 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:24:12 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:24:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:24:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:24:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:24:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:24:12 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:24:12 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:24:12 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.44s, races=5
2025-12-17 16:24:12 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:26:47 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:26:47 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:26:47 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:26:47 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:26:47 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:27:38 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:27:38 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:27:38 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:27:38 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:27:38 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:27:38 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:27:38 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:27:38 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:27:38 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:27:38 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:27:38 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:27:38 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:27:38 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:27:39 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.300s, null_city=4304
2025-12-17 16:27:39 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.069s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:27:39 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:27:39 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.185s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:27:39 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.076s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:27:40 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 1.155s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:27:40 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.006s)
2025-12-17 16:27:40 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:27:40 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.064s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:27:40 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.037s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:27:40 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:27:40 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:27:40 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:27:40 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:27:40 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.202s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:27:41 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.031s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:27:41 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:27:41 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.126s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:27:41 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0
2025-12-17 16:27:41 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.374s
2025-12-17 16:27:41 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.38s
2025-12-17 16:27:41 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:27:41 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.38s, groups=10
2025-12-17 16:27:41 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:27:41 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:27:41 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:27:42 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:27:42 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:27:42 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:27:42 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:27:42 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:27:42 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.43s, races=5
2025-12-17 16:27:42 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:30:22 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:30:22 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:30:22 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:30:22 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:30:22 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:30:22 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:30:22 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:30:22 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-17 16:30:22 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:30:22 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:30:22 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:30:22 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:30:22 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.007s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:30:22 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.280s, null_city=4304
2025-12-17 16:30:22 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.055s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:30:22 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:30:22 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.175s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:30:22 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.084s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:30:23 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.899s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:30:23 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.008s)
2025-12-17 16:30:23 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.047s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:30:23 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:30:23 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:30:24 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:30:24 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:30:24 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:30:24 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:30:24 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.159s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:30:24 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:30:24 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:30:24 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.107s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:30:24 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0
2025-12-17 16:30:24 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.985s
2025-12-17 16:30:24 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.99s
2025-12-17 16:30:24 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:30:24 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.37s, groups=10
2025-12-17 16:30:24 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:30:24 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:30:25 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:30:25 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:30:25 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:30:25 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:30:25 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:30:25 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:30:25 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.46s, races=5
2025-12-17 16:30:25 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.07s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:31:11 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:31:11 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:31:11 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:31:11 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:31:11 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:31:11 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:31:11 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:31:11 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.10s
2025-12-17 16:31:11 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:31:11 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:31:11 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:31:11 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:31:11 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.007s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:31:12 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.283s, null_city=4304
2025-12-17 16:31:12 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.064s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:31:12 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.012s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:31:12 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.196s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:31:12 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.079s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:31:13 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.895s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:31:13 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.009s)
2025-12-17 16:31:13 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.048s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:31:13 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.064s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:31:13 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.047s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:31:13 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:31:13 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:31:13 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:31:13 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:31:13 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.216s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:31:13 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.025s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:31:14 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:31:14 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.126s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:31:14 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.016s, age_center=35.0, age_scale=10.0
2025-12-17 16:31:14 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.128s
2025-12-17 16:31:14 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.13s
2025-12-17 16:31:14 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:31:14 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.35s, groups=10
2025-12-17 16:31:14 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:31:14 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:31:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:31:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:31:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:31:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:31:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:31:15 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:31:15 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.68s, races=5
2025-12-17 16:31:15 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:31:30 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:31:30 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:31:30 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:31:30 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:31:30 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:31:30 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:31:30 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:31:30 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:31:30 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:31:30 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:31:30 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:31:30 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:31:30 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:31:30 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.287s, null_city=4304
2025-12-17 16:31:30 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.038s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:31:30 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:31:30 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.150s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:31:30 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.071s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 1.128s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:31:32 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:31:32 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:31:32 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.159s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.026s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:31:32 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.106s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0
2025-12-17 16:31:32 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.150s
2025-12-17 16:31:32 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.15s
2025-12-17 16:31:32 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:31:32 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.34s, groups=10
2025-12-17 16:31:33 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:31:33 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:31:33 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:31:33 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:31:33 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:31:33 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:31:33 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:31:33 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:31:33 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.44s, races=5
2025-12-17 16:31:33 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:34:16 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:34:16 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:34:16 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:34:16 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:34:16 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:34:16 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:34:16 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:34:16 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:34:16 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:34:16 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:34:16 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:34:16 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:34:16 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:34:16 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.258s, null_city=4304
2025-12-17 16:34:16 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.041s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:34:16 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:34:16 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.135s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:34:16 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.074s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:34:17 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.857s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:34:17 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 16:34:17 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:34:17 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.051s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:34:17 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:34:17 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:34:18 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:34:18 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:34:18 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:34:18 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.152s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:34:18 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.034s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:34:18 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:34:18 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.112s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:34:18 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0
2025-12-17 16:34:18 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.859s
2025-12-17 16:34:18 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.86s
2025-12-17 16:34:18 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:34:18 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.36s, groups=10
2025-12-17 16:34:18 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:34:18 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:34:18 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:34:19 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:34:19 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:34:19 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:34:19 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:34:19 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:34:19 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.43s, races=5
2025-12-17 16:34:19 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:43:49 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:43:49 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:43:49 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:43:49 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:43:49 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:43:49 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:43:49 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:43:49 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.09s
2025-12-17 16:43:49 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:43:49 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 16:43:49 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:43:49 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:43:49 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:43:49 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.261s, null_city=4304
2025-12-17 16:43:49 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.035s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:43:49 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.028s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:43:49 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.168s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:43:49 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.098s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:43:50 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.883s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:43:50 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.018s)
2025-12-17 16:43:50 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.040s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:43:50 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.059s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:43:50 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.025s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:43:50 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:43:51 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:43:51 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:43:51 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:43:51 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.222s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:43:51 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.022s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:43:51 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:43:51 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.129s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:43:51 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.022s, age_center=35.0, age_scale=10.0
2025-12-17 16:43:51 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.058s
2025-12-17 16:43:51 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.06s
2025-12-17 16:43:51 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:43:51 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.35s, groups=10
2025-12-17 16:43:52 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:43:52 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:43:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:43:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:43:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:43:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:43:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:43:52 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:43:52 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.65s, races=5
2025-12-17 16:43:52 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:44:23 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:44:23 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:44:23 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:44:23 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:44:23 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:44:23 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:44:23 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:44:23 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.10s
2025-12-17 16:44:23 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 16:44:23 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.03s
2025-12-17 16:44:23 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:44:23 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:44:23 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:44:23 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.276s, null_city=4304
2025-12-17 16:44:23 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.073s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:44:23 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.016s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:44:24 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.322s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:44:24 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.121s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.999s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:44:25 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.014s)
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.050s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.071s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.034s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:44:25 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:44:25 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.231s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.031s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:44:25 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.140s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.024s, age_center=35.0, age_scale=10.0
2025-12-17 16:44:25 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.444s
2025-12-17 16:44:25 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.46s
2025-12-17 16:44:26 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:44:26 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.41s, groups=10
2025-12-17 16:44:26 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:44:26 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:44:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:44:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:44:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:44:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:44:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:44:27 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:44:27 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.74s, races=5
2025-12-17 16:44:27 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.06s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:46:35 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:46:35 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:46:35 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:46:35 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:46:35 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:46:35 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:46:35 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:46:35 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:46:35 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:46:35 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:46:35 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:46:35 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:46:35 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.008s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:46:35 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.251s, null_city=4304
2025-12-17 16:46:35 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.039s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:46:36 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:46:36 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.151s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:46:36 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.068s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.865s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:46:37 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.044s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:46:37 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:46:37 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.166s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.025s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:46:37 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.108s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.020s, age_center=35.0, age_scale=10.0
2025-12-17 16:46:37 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.862s
2025-12-17 16:46:37 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.87s
2025-12-17 16:46:37 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:46:37 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.40s, groups=10
2025-12-17 16:46:38 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:46:38 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:46:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:46:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:46:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:46:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:46:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:46:38 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:46:38 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.43s, races=5
2025-12-17 16:46:38 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.06s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:49:41 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:49:41 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:49:41 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:49:41 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:49:41 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:49:41 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:49:41 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:49:41 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:49:41 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:49:41 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:49:41 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:49:41 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:49:41 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:49:41 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.246s, null_city=4304
2025-12-17 16:49:41 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.038s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:49:41 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:49:41 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.139s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:49:42 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.074s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:49:42 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.859s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:49:42 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 16:49:42 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.042s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:49:42 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.049s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:49:43 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.031s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:49:43 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:49:43 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:49:43 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:49:43 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:49:43 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.151s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:49:43 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:49:43 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:49:43 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.101s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:49:43 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0
2025-12-17 16:49:43 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.818s
2025-12-17 16:49:43 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.82s
2025-12-17 16:49:43 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:49:43 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.34s, groups=10
2025-12-17 16:49:43 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:49:43 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:49:44 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:49:44 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:49:44 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:49:44 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:49:44 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:49:44 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:49:44 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.42s, races=5
2025-12-17 16:49:44 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 16:51:03 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:51:03 | INFO     | root                 | === Логирование включено ===
2025-12-17 16:51:03 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 16:51:03 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 16:51:03 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:51:03 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 16:51:03 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 16:51:03 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 16:51:03 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 16:51:03 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:51:03 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 16:51:03 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 16:51:03 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 16:51:04 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.245s, null_city=4304
2025-12-17 16:51:04 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.035s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 16:51:04 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 16:51:04 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.142s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 16:51:04 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.066s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.857s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 16:51:05 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.004s)
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 16:51:05 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 16:51:05 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.151s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.026s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 16:51:05 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.103s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.018s, age_center=35.0, age_scale=10.0
2025-12-17 16:51:05 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.809s
2025-12-17 16:51:05 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.81s
2025-12-17 16:51:05 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 16:51:05 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.34s, groups=10
2025-12-17 16:51:06 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 16:51:06 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 16:51:06 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 16:51:06 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 16:51:06 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 16:51:06 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 16:51:06 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 16:51:06 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 16:51:06 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.44s, races=5
2025-12-17 16:51:06 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 17:03:59 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:03:59 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:03:59 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:03:59 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:03:59 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:03:59 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:03:59 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:03:59 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-17 17:03:59 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 17:03:59 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:03:59 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:03:59 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:03:59 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.007s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:03:59 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.269s, null_city=4304
2025-12-17 17:03:59 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.057s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:03:59 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:04:00 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.168s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:04:00 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.088s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:04:00 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.874s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:04:00 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.004s)
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.056s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:04:01 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:04:01 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.165s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.025s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:04:01 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.111s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0
2025-12-17 17:04:01 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.952s
2025-12-17 17:04:01 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.96s
2025-12-17 17:04:01 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:04:01 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.39s, groups=10
2025-12-17 17:04:02 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:04:02 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:04:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:04:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:04:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:04:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:04:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:04:02 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:04:02 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.42s, races=5
2025-12-17 17:04:02 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 17:06:01 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:06:01 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:06:01 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:06:01 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:06:01 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:06:01 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:06:01 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:06:01 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 17:06:01 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 17:06:01 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:06:01 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:06:01 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:06:01 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.000s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:06:01 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.259s, null_city=4304
2025-12-17 17:06:01 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.057s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:06:01 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.007s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:06:01 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.166s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:06:01 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.073s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:06:02 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.870s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:06:02 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 17:06:02 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:06:02 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.055s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:06:02 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.031s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:06:02 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:06:02 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:06:02 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:06:02 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:06:02 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.160s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:06:02 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.024s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:06:03 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:06:03 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.106s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:06:03 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.018s, age_center=35.0, age_scale=10.0
2025-12-17 17:06:03 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.908s
2025-12-17 17:06:03 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.91s
2025-12-17 17:06:03 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:06:03 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.33s, groups=10
2025-12-17 17:06:03 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:06:03 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:06:03 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:06:03 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:06:03 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:06:03 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:06:03 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:06:04 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:06:04 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.43s, races=5
2025-12-17 17:06:04 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 17:14:34 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:14:34 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:14:34 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:14:34 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:14:34 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:14:34 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:14:34 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:14:34 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 17:14:34 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 17:14:34 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:14:34 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:14:34 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:14:34 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:14:34 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.245s, null_city=4304
2025-12-17 17:14:34 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.054s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:14:34 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:14:34 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.152s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:14:34 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.061s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:14:35 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.863s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:14:35 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.004s)
2025-12-17 17:14:35 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.042s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:14:35 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.049s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:14:35 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.028s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:14:35 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:14:35 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:14:35 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:14:35 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:14:35 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.146s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:14:35 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:14:36 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:14:36 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.144s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:14:36 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.022s, age_center=35.0, age_scale=10.0
2025-12-17 17:14:36 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.880s
2025-12-17 17:14:36 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.88s
2025-12-17 17:14:36 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:14:36 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.35s, groups=10
2025-12-17 17:14:36 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:14:36 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:14:36 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:14:36 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:14:36 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:14:37 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:14:37 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:14:37 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:14:37 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.41s, races=5
2025-12-17 17:14:37 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 17:14:44 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:14:44 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:14:44 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:14:44 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:14:44 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:14:44 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:14:44 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:14:44 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-17 17:14:44 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 17:14:44 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:14:44 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:14:44 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:14:44 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:14:44 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.252s, null_city=4304
2025-12-17 17:14:44 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.038s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:14:44 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:14:45 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.182s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:14:45 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.068s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.923s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:14:46 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.032s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:14:46 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:14:46 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.178s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.029s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:14:46 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.133s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.022s, age_center=35.0, age_scale=10.0
2025-12-17 17:14:46 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.009s
2025-12-17 17:14:46 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.01s
2025-12-17 17:14:47 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:14:47 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.43s, groups=10
2025-12-17 17:14:47 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:14:47 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:14:47 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:14:47 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:14:47 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:14:47 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:14:47 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:14:47 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:14:47 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.50s, races=5
2025-12-17 17:14:47 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.06s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 17:16:19 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:16:19 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:16:19 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:16:19 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:16:19 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:16:19 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:16:19 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:16:19 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.08s
2025-12-17 17:16:19 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 17:16:19 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:16:19 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.00s
2025-12-17 17:16:19 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:16:19 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.000s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:16:19 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.268s, null_city=4304
2025-12-17 17:16:19 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.048s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:16:19 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:16:19 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.163s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:16:19 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.098s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:16:20 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.863s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:16:20 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.016s)
2025-12-17 17:16:20 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:16:20 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.062s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:16:20 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.054s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:16:20 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:16:20 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:16:20 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:16:20 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:16:20 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.212s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:16:20 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.025s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:16:21 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:16:21 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.142s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:16:21 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.007s, age_center=35.0, age_scale=10.0
2025-12-17 17:16:21 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.024s
2025-12-17 17:16:21 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.02s
2025-12-17 17:16:21 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:16:21 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.35s, groups=10
2025-12-17 17:16:21 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:16:21 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:16:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:16:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:16:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:16:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:16:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:16:22 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:16:22 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.67s, races=5
2025-12-17 17:16:22 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.06s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 17:17:26 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:17:26 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:17:58 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:17:58 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:17:58 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:17:58 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:17:58 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:17:58 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:17:58 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:17:58 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 17:17:58 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 17:17:58 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:17:58 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:17:58 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:17:58 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:17:58 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.255s, null_city=4304
2025-12-17 17:17:59 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.044s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:17:59 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:17:59 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.153s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:17:59 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.060s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.856s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:18:00 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.041s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.048s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.028s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:18:00 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:18:00 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.157s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.028s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:18:00 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.106s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0
2025-12-17 17:18:00 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.843s
2025-12-17 17:18:00 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.85s
2025-12-17 17:18:00 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:18:00 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.34s, groups=10
2025-12-17 17:18:01 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:18:01 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:18:01 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:18:01 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:18:01 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:18:01 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:18:01 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:18:01 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:18:01 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.41s, races=5
2025-12-17 17:18:01 | INFO     | main                 | fit_age_model: rows 42357 → 42357, elapsed 0.05s, validation_year=0, dropped_by_year=0, dropped_by_na=0
2025-12-17 17:19:56 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:19:56 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:19:56 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:19:56 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:19:56 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:19:57 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:19:57 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:19:57 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 17:19:57 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 17:19:57 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:19:57 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:19:57 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:19:57 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.007s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:19:57 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.261s, null_city=4304
2025-12-17 17:19:57 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.050s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:19:57 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:19:57 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.149s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:19:57 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.072s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:19:58 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.896s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:19:58 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 17:19:58 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.043s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:19:58 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.051s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:19:58 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:19:58 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:19:58 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:19:58 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:19:58 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:19:58 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.171s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:19:58 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.035s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:19:58 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:19:59 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.134s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:19:59 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.022s, age_center=35.0, age_scale=10.0
2025-12-17 17:19:59 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.969s
2025-12-17 17:19:59 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.97s
2025-12-17 17:19:59 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:19:59 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.40s, groups=10
2025-12-17 17:19:59 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:19:59 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:19:59 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:19:59 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:20:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:20:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:20:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:20:00 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:20:00 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.46s, races=5
2025-12-17 17:20:52 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:20:52 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:20:56 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:20:56 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:20:56 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:20:56 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:20:56 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:20:56 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.08s
2025-12-17 17:20:56 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 17:20:56 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:20:56 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:20:56 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:20:56 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:20:57 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.256s, null_city=4304
2025-12-17 17:20:57 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.059s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:20:57 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.014s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:20:57 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.165s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:20:57 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.094s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:20:58 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.962s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:20:58 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.016s)
2025-12-17 17:20:58 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:20:58 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:20:58 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.051s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:20:58 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:20:58 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:20:58 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:20:58 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:20:58 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.245s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:20:58 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.023s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:20:59 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:20:59 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.159s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:20:59 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.016s, age_center=35.0, age_scale=10.0
2025-12-17 17:20:59 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.242s
2025-12-17 17:20:59 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.24s
2025-12-17 17:20:59 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:20:59 | INFO     | main                 | build_trace_references: rows 42357 → 10, elapsed 0.40s, groups=10
2025-12-17 17:20:59 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:20:59 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:21:00 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:21:00 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:21:00 | INFO     | main                 | build_age_references: rows 42357 → 334, elapsed 0.69s, races=5
2025-12-17 17:32:47 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:32:47 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:32:47 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:32:47 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:32:47 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:32:47 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:32:47 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:32:47 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.11s
2025-12-17 17:32:47 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.03s
2025-12-17 17:32:47 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.03s
2025-12-17 17:32:47 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:32:47 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:32:47 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.008s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:32:47 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.282s, null_city=4304
2025-12-17 17:32:47 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.041s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:32:47 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:32:48 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.175s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:32:48 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.076s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:32:48 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.903s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:32:49 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.043s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.050s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:32:49 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:32:49 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.157s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.026s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:32:49 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.115s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0
2025-12-17 17:32:49 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.975s
2025-12-17 17:32:49 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.98s
2025-12-17 17:32:49 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-17 17:32:49 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:32:49 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.34s, groups=10
2025-12-17 17:32:50 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:32:50 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:32:50 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:39:59 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:39:59 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:39:59 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:39:59 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:39:59 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:39:59 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:39:59 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:39:59 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.08s
2025-12-17 17:39:59 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 17:39:59 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:39:59 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:39:59 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:39:59 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.008s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:39:59 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.270s, null_city=4304
2025-12-17 17:39:59 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.040s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:39:59 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:40:00 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.169s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:40:00 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.064s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.922s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:40:01 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.058s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.066s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.032s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:40:01 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:40:01 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.159s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:40:01 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.106s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.020s, age_center=35.0, age_scale=10.0
2025-12-17 17:40:01 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.972s
2025-12-17 17:40:01 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.97s
2025-12-17 17:40:01 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-17 17:40:01 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:40:01 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.34s, groups=10
2025-12-17 17:40:02 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:40:02 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:40:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:40:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:40:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:40:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:40:02 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:40:02 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:40:02 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.40s, races=5
2025-12-17 17:40:02 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-17 17:49:04 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:49:04 | INFO     | root                 | === Логирование включено ===
2025-12-17 17:49:04 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 17:49:04 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 17:49:04 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:49:04 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 17:49:04 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 17:49:04 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.20s
2025-12-17 17:49:04 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 17:49:04 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 17:49:04 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 17:49:04 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 17:49:04 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.007s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 17:49:04 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.271s, null_city=4304
2025-12-17 17:49:05 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.057s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 17:49:05 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 17:49:05 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.175s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 17:49:05 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.085s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.912s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 17:49:06 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.010s)
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.035s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 17:49:06 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 17:49:06 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.189s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.033s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 17:49:06 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.124s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.020s, age_center=35.0, age_scale=10.0
2025-12-17 17:49:06 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.064s
2025-12-17 17:49:06 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.07s
2025-12-17 17:49:06 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.08s, validation_year=2025
2025-12-17 17:49:07 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 17:49:07 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.38s, groups=10
2025-12-17 17:49:07 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 17:49:07 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 17:49:07 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 17:49:07 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 17:49:07 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 17:49:07 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 17:49:07 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 17:49:07 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 17:49:07 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.43s, races=5
2025-12-17 17:49:07 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-17 18:02:19 | INFO     | root                 | === Логирование включено ===
2025-12-17 18:02:19 | INFO     | root                 | === Логирование включено ===
2025-12-17 18:02:19 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 18:02:19 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 18:02:19 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:02:19 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 18:02:19 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:02:19 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-17 18:02:19 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 18:02:19 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 18:02:19 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 18:02:19 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 18:02:19 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.007s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 18:02:19 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.278s, null_city=4304
2025-12-17 18:02:19 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.042s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 18:02:19 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 18:02:19 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.168s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 18:02:19 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.068s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 18:02:20 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.886s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 18:02:20 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 18:02:20 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.047s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 18:02:20 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.055s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 18:02:20 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 18:02:20 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 18:02:21 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 18:02:21 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 18:02:21 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 18:02:21 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.181s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 18:02:21 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.033s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 18:02:21 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 18:02:21 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.123s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 18:02:21 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.025s, age_center=35.0, age_scale=10.0
2025-12-17 18:02:21 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.987s
2025-12-17 18:02:21 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.99s
2025-12-17 18:02:21 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.09s, validation_year=2025
2025-12-17 18:02:21 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 18:02:21 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.35s, groups=10
2025-12-17 18:02:21 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 18:02:21 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 18:02:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 18:02:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 18:02:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 18:02:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 18:02:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 18:02:22 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 18:02:22 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.44s, races=5
2025-12-17 18:02:22 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-17 18:05:48 | INFO     | root                 | === Логирование включено ===
2025-12-17 18:05:48 | INFO     | root                 | === Логирование включено ===
2025-12-17 18:05:48 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 18:05:48 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 18:05:48 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:05:48 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 18:05:48 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:05:48 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 18:05:48 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 18:05:48 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 18:05:48 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 18:05:48 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 18:05:48 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 18:05:49 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.246s, null_city=4304
2025-12-17 18:05:49 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.036s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 18:05:49 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 18:05:49 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.158s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 18:05:49 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.065s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.860s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 18:05:50 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.044s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.051s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 18:05:50 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 18:05:50 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.154s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.024s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 18:05:50 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.102s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.018s, age_center=35.0, age_scale=10.0
2025-12-17 18:05:50 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.825s
2025-12-17 18:05:50 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.83s
2025-12-17 18:05:50 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.07s, validation_year=2025
2025-12-17 18:05:51 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 18:05:51 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.33s, groups=10
2025-12-17 18:05:51 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 18:05:51 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 18:05:51 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 18:05:51 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 18:05:51 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 18:05:51 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 18:05:51 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 18:05:51 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 18:05:51 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.40s, races=5
2025-12-17 18:05:51 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-17 18:12:14 | INFO     | root                 | === Логирование включено ===
2025-12-17 18:12:14 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 18:12:14 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 18:12:14 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:12:14 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 18:12:14 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:12:14 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 18:12:14 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 18:12:14 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 18:12:14 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 18:12:14 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 18:12:14 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 18:12:14 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.246s, null_city=4304
2025-12-17 18:12:14 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.036s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 18:12:14 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 18:12:14 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.135s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 18:12:14 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.065s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 18:12:15 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.878s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 18:12:15 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 18:12:15 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.043s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 18:12:15 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.049s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 18:12:15 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 18:12:15 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 18:12:15 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 18:12:15 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 18:12:15 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 18:12:15 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.158s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 18:12:15 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.037s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 18:12:16 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 18:12:16 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.112s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 18:12:16 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.020s, age_center=35.0, age_scale=10.0
2025-12-17 18:12:16 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.866s
2025-12-17 18:12:16 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.87s
2025-12-17 18:12:16 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-17 18:12:16 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 18:12:16 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.32s, groups=10
2025-12-17 18:12:16 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 18:12:16 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 18:12:16 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 18:12:16 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 18:12:17 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 18:12:17 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 18:12:17 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 18:12:17 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 18:12:17 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.46s, races=5
2025-12-17 18:12:17 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-17 18:14:37 | INFO     | root                 | === Логирование включено ===
2025-12-17 18:14:37 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 18:14:37 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 18:14:37 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:14:38 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 18:14:38 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:14:38 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 18:14:38 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.03s
2025-12-17 18:14:38 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.03s
2025-12-17 18:14:38 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 18:14:38 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 18:14:38 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 18:14:38 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.265s, null_city=4304
2025-12-17 18:14:38 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.042s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 18:14:38 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-17 18:14:38 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.189s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 18:14:38 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.068s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 18:14:39 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.917s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 18:14:39 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 18:14:39 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 18:14:39 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 18:14:39 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 18:14:39 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 18:14:39 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 18:14:39 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 18:14:39 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 18:14:39 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.163s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 18:14:39 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.028s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 18:14:40 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 18:14:40 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.119s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 18:14:40 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0
2025-12-17 18:14:40 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.987s
2025-12-17 18:14:40 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.99s
2025-12-17 18:14:40 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-17 18:14:40 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 18:14:40 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.39s, groups=10
2025-12-17 18:14:40 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 18:14:40 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 18:14:40 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 18:14:41 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 18:14:41 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 18:14:41 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 18:14:41 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 18:14:41 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 18:14:41 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.48s, races=5
2025-12-17 18:14:41 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-17 18:23:49 | INFO     | root                 | === Логирование включено ===
2025-12-17 18:23:49 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 18:23:49 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 18:23:49 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:23:49 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 18:23:49 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:23:49 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-17 18:23:49 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-17 18:23:49 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-17 18:23:49 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 18:23:49 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 18:23:49 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 18:23:49 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.307s, null_city=4304
2025-12-17 18:23:49 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.039s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 18:23:49 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-17 18:23:50 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.190s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 18:23:50 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.081s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.962s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 18:23:51 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.042s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.049s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 18:23:51 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 18:23:51 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.156s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.025s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 18:23:51 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.118s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0
2025-12-17 18:23:51 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.072s
2025-12-17 18:23:51 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.07s
2025-12-17 18:23:51 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.07s, validation_year=2025
2025-12-17 18:23:52 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 18:23:52 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.36s, groups=10
2025-12-17 18:23:52 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 18:23:52 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 18:23:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 18:23:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 18:23:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 18:23:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 18:23:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 18:23:52 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 18:23:52 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.45s, races=5
2025-12-17 18:23:52 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-17 18:26:08 | INFO     | root                 | === Логирование включено ===
2025-12-17 18:26:08 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-17 18:26:08 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-17 18:26:08 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:26:08 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-17 18:26:08 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-17 18:26:08 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-17 18:26:08 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-17 18:26:08 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-17 18:26:08 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-17 18:26:08 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-17 18:26:08 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-17 18:26:09 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.241s, null_city=4304
2025-12-17 18:26:09 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.039s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-17 18:26:09 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-17 18:26:09 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.158s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-17 18:26:09 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.073s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.874s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-17 18:26:10 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.042s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.049s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.028s, changed_rows=5053, affected_runner_ids=1405
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-17 18:26:10 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-17 18:26:10 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.151s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.023s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-17 18:26:10 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.105s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0
2025-12-17 18:26:10 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.841s
2025-12-17 18:26:10 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.84s
2025-12-17 18:26:10 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-17 18:26:10 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-17 18:26:10 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.33s, groups=10
2025-12-17 18:26:11 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-17 18:26:11 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-17 18:26:11 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-17 18:26:11 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-17 18:26:11 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-17 18:26:11 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-17 18:26:11 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-17 18:26:11 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-17 18:26:11 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.40s, races=5
2025-12-17 18:26:11 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 10:49:35 | INFO     | root                 | === Логирование включено ===
2025-12-18 10:49:35 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 10:49:35 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 10:49:35 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 10:49:35 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 10:49:35 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 10:49:35 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.26s
2025-12-18 10:49:35 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 10:49:35 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 10:49:35 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.02s
2025-12-18 10:49:35 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 10:49:35 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 10:49:35 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.268s, null_city=4304
2025-12-18 10:49:35 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.059s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 10:49:35 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-18 10:49:36 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.271s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 10:49:36 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.066s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.868s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 10:49:37 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.010s)
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.031s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-18 10:49:37 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 10:49:37 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.210s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.030s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 10:49:37 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.124s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0
2025-12-18 10:49:37 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.099s
2025-12-18 10:49:37 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.10s
2025-12-18 10:49:37 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.08s, validation_year=2025
2025-12-18 10:49:38 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 10:49:38 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.43s, groups=10
2025-12-18 10:49:38 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-18 10:49:38 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 10:49:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 10:49:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-18 10:49:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 10:49:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 10:49:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 10:49:38 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-18 10:49:38 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.42s, races=5
2025-12-18 10:49:38 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.01s, validation_year=2025
2025-12-18 10:58:43 | INFO     | root                 | === Логирование включено ===
2025-12-18 10:58:43 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 10:58:43 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 10:58:43 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 10:58:43 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 10:58:43 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 10:58:43 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-18 10:58:43 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-18 10:58:43 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 10:58:43 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 10:58:43 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 10:58:43 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 10:58:43 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.250s, null_city=4304
2025-12-18 10:58:43 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.051s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 10:58:43 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-18 10:58:43 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.183s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 10:58:44 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.071s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 10:58:44 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.887s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 10:58:44 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.049s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.058s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.033s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-18 10:58:45 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 10:58:45 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.167s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.026s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 10:58:45 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.119s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.020s, age_center=35.0, age_scale=10.0
2025-12-18 10:58:45 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.955s
2025-12-18 10:58:45 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.96s
2025-12-18 10:58:45 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.07s, validation_year=2025
2025-12-18 10:58:45 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 10:58:45 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.40s, groups=10
2025-12-18 10:58:46 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-18 10:58:46 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 10:58:46 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 10:58:46 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-18 10:58:46 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 10:58:46 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 10:58:46 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 10:58:46 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-18 10:58:46 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.49s, races=5
2025-12-18 10:58:46 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 10:59:12 | INFO     | root                 | === Логирование включено ===
2025-12-18 10:59:12 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 10:59:12 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 10:59:12 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 10:59:12 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 10:59:12 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 10:59:12 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-18 10:59:12 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 10:59:12 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 10:59:12 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 10:59:12 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 10:59:12 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 10:59:12 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.360s, null_city=4304
2025-12-18 10:59:12 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.094s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 10:59:12 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.009s, na_birth_year=0, unique_birth_years=73
2025-12-18 10:59:12 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.242s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 10:59:12 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.075s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 10:59:13 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 1.010s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 10:59:13 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.004s)
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.032s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-18 10:59:14 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 10:59:14 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.164s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.030s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 10:59:14 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.144s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.023s, age_center=35.0, age_scale=10.0
2025-12-18 10:59:14 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.338s
2025-12-18 10:59:14 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.34s
2025-12-18 10:59:14 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.10s, validation_year=2025
2025-12-18 10:59:14 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 10:59:14 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.40s, groups=10
2025-12-18 10:59:15 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-18 10:59:15 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 10:59:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 10:59:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 91 возрастных медиан
2025-12-18 10:59:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 10:59:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 10:59:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 10:59:15 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=334
2025-12-18 10:59:15 | INFO     | main                 | build_age_references: rows 36205 → 334, elapsed 0.45s, races=5
2025-12-18 10:59:15 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 11:06:15 | INFO     | root                 | === Логирование включено ===
2025-12-18 11:06:15 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 11:06:15 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 11:06:15 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:06:15 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 11:06:15 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:06:15 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-18 11:06:15 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-18 11:06:15 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-18 11:06:15 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 11:06:15 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 11:06:15 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 11:06:15 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.344s, null_city=4304
2025-12-18 11:06:15 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.053s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 11:06:15 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-18 11:06:15 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.204s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 11:06:15 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.063s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 11:06:16 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.867s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 11:06:16 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-18 11:06:16 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 11:06:16 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 11:06:16 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 11:06:16 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 11:06:17 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-18 11:06:17 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 11:06:17 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 11:06:17 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.162s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 11:06:17 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.029s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 11:06:17 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 11:06:17 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.125s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 11:06:17 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.027s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 11:06:17 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.051s
2025-12-18 11:06:17 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.05s
2025-12-18 11:06:17 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.07s, validation_year=2025
2025-12-18 11:06:17 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 11:06:17 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.34s, groups=10
2025-12-18 11:06:17 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-18 11:06:17 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 11:06:17 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 11:06:18 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 11:06:18 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 11:06:18 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 11:06:18 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 11:06:18 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=335
2025-12-18 11:06:18 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.42s, races=5
2025-12-18 11:06:18 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 11:21:16 | INFO     | root                 | === Логирование включено ===
2025-12-18 11:21:16 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 11:21:16 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 11:21:16 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:21:16 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 11:21:16 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:21:16 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-18 11:21:16 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-18 11:21:16 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-18 11:21:16 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 11:21:16 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 11:21:16 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.004s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 11:21:16 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.241s, null_city=4304
2025-12-18 11:21:16 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.037s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 11:21:16 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-18 11:21:16 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.136s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 11:21:16 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.065s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 11:21:17 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.909s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 11:21:17 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-18 11:21:17 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 11:21:17 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 11:21:17 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 11:21:17 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 11:21:17 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-18 11:21:17 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 11:21:17 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 11:21:17 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.182s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 11:21:17 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.026s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 11:21:18 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 11:21:18 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.113s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 11:21:18 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.022s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 11:21:18 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.905s
2025-12-18 11:21:18 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.91s
2025-12-18 11:21:18 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-18 11:21:18 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 11:21:18 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.31s, groups=10
2025-12-18 11:21:18 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-18 11:21:18 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 11:21:18 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 11:21:18 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 11:21:18 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 11:21:19 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 11:21:19 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 11:21:19 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=335
2025-12-18 11:21:19 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.40s, races=5
2025-12-18 11:21:19 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 11:30:22 | INFO     | root                 | === Логирование включено ===
2025-12-18 11:30:22 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 11:30:22 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 11:30:22 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:30:22 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 11:30:22 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:30:22 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-18 11:30:23 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 11:30:23 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 11:30:23 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 11:30:23 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 11:30:23 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.007s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 11:30:23 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.284s, null_city=4304
2025-12-18 11:30:23 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.039s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 11:30:23 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-18 11:30:23 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.159s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 11:30:23 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.073s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 11:30:24 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.899s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 11:30:24 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-18 11:30:24 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.045s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 11:30:24 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.052s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 11:30:24 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.033s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 11:30:24 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 11:30:24 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-18 11:30:24 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 11:30:24 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 11:30:24 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.182s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 11:30:24 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.032s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 11:30:24 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 11:30:25 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.127s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 11:30:25 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.023s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 11:30:25 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.008s
2025-12-18 11:30:25 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.01s
2025-12-18 11:30:25 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.09s, validation_year=2025
2025-12-18 11:30:25 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 11:30:25 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.36s, groups=10
2025-12-18 11:30:25 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-18 11:30:25 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 11:30:25 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 11:30:25 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 11:30:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 11:30:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 11:30:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 11:30:26 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=335
2025-12-18 11:30:26 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.42s, races=5
2025-12-18 11:30:26 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 11:33:55 | INFO     | root                 | === Логирование включено ===
2025-12-18 11:33:55 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 11:33:55 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 11:33:55 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:33:55 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 11:33:55 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:33:55 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.08s
2025-12-18 11:33:55 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 11:33:55 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 11:33:55 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.02s
2025-12-18 11:33:55 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 11:33:55 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.009s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 11:33:55 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.275s, null_city=4304
2025-12-18 11:33:55 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.041s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 11:33:55 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-18 11:33:55 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.159s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 11:33:55 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.066s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 11:33:56 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.926s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 11:33:56 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.004s)
2025-12-18 11:33:56 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 11:33:56 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 11:33:56 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.031s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 11:33:56 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 11:33:56 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-18 11:33:56 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 11:33:56 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 11:33:56 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.170s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 11:33:56 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.029s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 11:33:57 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 11:33:57 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.105s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 11:33:57 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 11:33:57 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.974s
2025-12-18 11:33:57 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.98s
2025-12-18 11:33:57 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.07s, validation_year=2025
2025-12-18 11:33:57 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 11:33:57 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.33s, groups=10
2025-12-18 11:33:57 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-18 11:33:57 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 11:33:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 11:33:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 11:33:58 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 11:33:58 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 11:33:58 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 11:33:58 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=335
2025-12-18 11:33:58 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.42s, races=5
2025-12-18 11:33:58 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 11:51:12 | INFO     | root                 | === Логирование включено ===
2025-12-18 11:51:12 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 11:51:12 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 11:51:12 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:51:12 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 11:51:12 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:51:12 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.23s
2025-12-18 11:51:12 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 11:51:12 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 11:51:12 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 11:51:12 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 11:51:12 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 11:51:12 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.253s, null_city=4304
2025-12-18 11:51:12 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.040s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 11:51:12 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-18 11:51:12 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.168s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 11:51:13 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.071s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 11:51:13 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.880s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 11:51:13 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-18 11:51:13 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 11:51:13 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 11:51:14 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 11:51:14 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 11:51:14 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority report saved: C:\Users\andre\github\Marathons\test_outputs\gender_fixes.txt
2025-12-18 11:51:14 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 11:51:14 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 11:51:14 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.161s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 11:51:14 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.028s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 11:51:14 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 11:51:14 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.109s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 11:51:14 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 11:51:14 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.905s
2025-12-18 11:51:14 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.91s
2025-12-18 11:51:14 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.07s, validation_year=2025
2025-12-18 11:51:14 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 11:51:14 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.44s, groups=10
2025-12-18 11:51:15 | INFO     | trace_reference_builder | Trace references saved: C:\Users\andre\github\Marathons\test_outputs\trace_references.xlsx, rows=10
2025-12-18 11:51:15 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 11:51:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 11:51:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 11:51:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 11:51:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 11:51:15 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 11:51:15 | INFO     | age_reference_builder | Age references saved: C:\Users\andre\github\Marathons\test_outputs\age_references.xlsx, rows=335
2025-12-18 11:51:15 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.45s, races=5
2025-12-18 11:51:15 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.01s, validation_year=2025
2025-12-18 11:59:36 | INFO     | root                 | === Логирование включено ===
2025-12-18 11:59:36 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 11:59:36 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 11:59:36 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:59:36 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 11:59:36 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 11:59:36 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-18 11:59:36 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-18 11:59:36 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 11:59:36 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 11:59:36 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 11:59:36 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 11:59:36 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.245s, null_city=4304
2025-12-18 11:59:36 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.037s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 11:59:36 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-18 11:59:36 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.140s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 11:59:36 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.075s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 11:59:37 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.857s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 11:59:37 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.042s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 11:59:37 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.050s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 11:59:37 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 11:59:37 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 11:59:37 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 11:59:37 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 11:59:37 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.145s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 11:59:37 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.026s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 11:59:38 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 11:59:38 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.112s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 11:59:38 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.020s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 11:59:38 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.813s
2025-12-18 11:59:38 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.82s
2025-12-18 11:59:38 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-18 11:59:38 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 11:59:38 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.36s, groups=10
2025-12-18 11:59:38 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 11:59:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 11:59:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 11:59:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 11:59:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 11:59:38 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 11:59:38 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.43s, races=5
2025-12-18 11:59:38 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 12:06:19 | INFO     | root                 | === Логирование включено ===
2025-12-18 12:06:19 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 12:06:19 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 12:06:19 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:06:19 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 12:06:19 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:06:19 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.23s
2025-12-18 12:06:19 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-18 12:06:19 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 12:06:19 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.02s
2025-12-18 12:06:19 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 12:06:19 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 12:06:19 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.243s, null_city=4304
2025-12-18 12:06:19 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.042s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 12:06:19 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.006s, na_birth_year=0, unique_birth_years=73
2025-12-18 12:06:20 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.164s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 12:06:20 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.074s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.880s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.056s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.028s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 12:06:21 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 12:06:21 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.151s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.025s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 12:06:21 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.112s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.020s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 12:06:21 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.874s
2025-12-18 12:06:21 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.88s
2025-12-18 12:06:21 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.05s, validation_year=2025
2025-12-18 12:06:21 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 12:06:21 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.32s, groups=10
2025-12-18 12:06:21 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 12:06:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 12:06:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 12:06:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 12:06:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 12:06:22 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 12:06:22 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.41s, races=5
2025-12-18 12:06:22 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 12:09:50 | INFO     | root                 | === Логирование включено ===
2025-12-18 12:09:50 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 12:09:50 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 12:09:50 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:09:50 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 12:09:50 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:09:50 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-18 12:09:50 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.03s
2025-12-18 12:09:50 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 12:09:50 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 12:09:50 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 12:09:51 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.008s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 12:09:51 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.254s, null_city=4304
2025-12-18 12:09:51 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.046s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 12:09:51 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-18 12:09:51 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.224s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 12:09:51 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.074s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.868s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.055s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.031s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 12:09:52 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 12:09:52 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.175s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.031s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 12:09:52 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.121s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 12:09:52 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.997s
2025-12-18 12:09:52 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.00s
2025-12-18 12:09:53 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.07s, validation_year=2025
2025-12-18 12:09:53 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 12:09:53 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.34s, groups=10
2025-12-18 12:09:53 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 12:09:53 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 12:09:53 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 12:09:53 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 12:09:53 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 12:09:53 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 12:09:53 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.40s, races=5
2025-12-18 12:09:53 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 12:50:23 | INFO     | root                 | === Логирование включено ===
2025-12-18 12:50:23 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 12:50:23 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 12:50:23 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:50:24 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 12:50:24 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:50:24 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.24s
2025-12-18 12:50:24 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 12:50:24 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 12:50:24 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.02s
2025-12-18 12:50:24 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 12:50:24 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.008s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 12:50:24 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.290s, null_city=4304
2025-12-18 12:50:24 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.062s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 12:50:24 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.009s, na_birth_year=0, unique_birth_years=73
2025-12-18 12:50:24 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.216s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 12:50:24 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.082s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 12:50:25 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.886s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 12:50:25 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 12:50:25 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.061s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 12:50:25 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.032s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 12:50:26 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 12:50:26 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 12:50:26 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 12:50:26 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.184s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 12:50:26 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.030s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 12:50:26 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 12:50:26 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.128s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 12:50:26 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.024s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 12:50:26 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.089s
2025-12-18 12:50:26 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.09s
2025-12-18 12:50:26 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.08s, validation_year=2025
2025-12-18 12:50:26 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 12:50:26 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.42s, groups=10
2025-12-18 12:50:26 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 12:50:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 12:50:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 12:50:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 12:50:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 12:50:27 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 12:50:27 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.48s, races=5
2025-12-18 12:50:27 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.01s, validation_year=2025
2025-12-18 12:50:27 | INFO     | spline_model.spline_tests.test_real_data | OK: real_data build_raw_basis:
2025-12-18 12:50:54 | INFO     | root                 | === Логирование включено ===
2025-12-18 12:50:54 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 12:50:54 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 12:50:54 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:50:54 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 12:50:54 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:50:54 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-18 12:50:54 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 12:50:54 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.03s
2025-12-18 12:50:54 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 12:50:54 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 12:50:54 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.008s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 12:50:54 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.270s, null_city=4304
2025-12-18 12:50:54 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.052s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 12:50:54 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-18 12:50:54 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.169s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 12:50:54 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.068s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 12:50:55 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.900s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 12:50:55 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.056s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 12:50:55 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.065s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 12:50:55 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.064s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 12:50:55 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 12:50:56 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 12:50:56 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 12:50:56 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.210s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 12:50:56 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.032s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 12:50:56 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 12:50:56 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.138s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 12:50:56 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.031s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 12:50:56 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.128s
2025-12-18 12:50:56 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.14s
2025-12-18 12:50:56 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.09s, validation_year=2025
2025-12-18 12:50:56 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 12:50:56 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.43s, groups=10
2025-12-18 12:50:56 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 12:50:56 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 12:50:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 12:50:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 12:50:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 12:50:57 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 12:50:57 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.47s, races=5
2025-12-18 12:50:57 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 12:50:57 | INFO     | spline_model.spline_tests.test_real_data | OK: real_data build_raw_basis:
2025-12-18 12:51:23 | INFO     | root                 | === Логирование включено ===
2025-12-18 12:51:23 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 12:51:23 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 12:51:23 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:51:23 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 12:51:23 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:51:23 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-18 12:51:23 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 12:51:23 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 12:51:23 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 12:51:23 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 12:51:23 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.009s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 12:51:23 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.261s, null_city=4304
2025-12-18 12:51:23 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.044s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 12:51:23 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.014s, na_birth_year=0, unique_birth_years=73
2025-12-18 12:51:23 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.178s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 12:51:23 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.065s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 12:51:24 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.883s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 12:51:24 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.051s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 12:51:24 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.059s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 12:51:24 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.042s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 12:51:24 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 12:51:24 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 12:51:24 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 12:51:24 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.182s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 12:51:25 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.036s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 12:51:25 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 12:51:25 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.131s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 12:51:25 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.027s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 12:51:25 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.026s
2025-12-18 12:51:25 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.03s
2025-12-18 12:51:25 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.10s, validation_year=2025
2025-12-18 12:51:25 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 12:51:25 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.44s, groups=10
2025-12-18 12:51:25 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 12:51:25 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 12:51:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 12:51:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 12:51:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 12:51:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 12:51:26 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.47s, races=5
2025-12-18 12:51:26 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 12:51:40 | INFO     | root                 | === Логирование включено ===
2025-12-18 12:51:40 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 12:51:40 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 12:51:40 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:51:40 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 12:51:40 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 12:51:40 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-18 12:51:40 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 12:51:40 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 12:51:40 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 12:51:40 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 12:51:40 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.007s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 12:51:40 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.251s, null_city=4304
2025-12-18 12:51:40 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.037s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 12:51:40 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-18 12:51:40 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.155s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 12:51:40 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.069s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 12:51:41 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.885s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 12:51:41 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.049s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 12:51:41 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.057s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 12:51:41 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.035s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 12:51:41 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 12:51:42 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 12:51:42 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 12:51:42 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.156s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 12:51:42 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.029s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 12:51:42 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 12:51:42 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.111s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 12:51:42 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.022s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 12:51:42 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.899s
2025-12-18 12:51:42 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.90s
2025-12-18 12:51:42 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.09s, validation_year=2025
2025-12-18 12:51:42 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 12:51:42 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.45s, groups=10
2025-12-18 12:51:42 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 12:51:43 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 12:51:43 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 12:51:43 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 12:51:43 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 12:51:43 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 12:51:43 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.53s, races=5
2025-12-18 12:51:43 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 13:06:23 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:06:23 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 13:06:23 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 13:06:23 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 13:06:23 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 13:06:23 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 13:06:23 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-18 13:06:23 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-18 13:06:23 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-18 13:06:23 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 13:06:23 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 13:06:23 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 13:06:24 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.246s, null_city=4304
2025-12-18 13:06:24 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.039s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 13:06:24 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-18 13:06:24 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.147s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 13:06:24 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.067s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.867s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.047s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.055s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.030s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 13:06:25 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 13:06:25 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.164s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.028s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 13:06:25 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.109s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.023s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 13:06:25 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.856s
2025-12-18 13:06:25 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.86s
2025-12-18 13:06:25 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.08s, validation_year=2025
2025-12-18 13:06:26 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 13:06:26 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.37s, groups=10
2025-12-18 13:06:26 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 13:06:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 13:06:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 13:06:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 13:06:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 13:06:26 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 13:06:26 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.41s, races=5
2025-12-18 13:06:26 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 13:07:42 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:07:42 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 13:07:42 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 13:07:42 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 13:07:42 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 13:07:42 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 13:07:42 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-18 13:07:42 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 13:07:42 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 13:07:42 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 13:07:42 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 13:07:42 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 13:07:42 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.260s, null_city=4304
2025-12-18 13:07:42 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.044s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 13:07:42 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-18 13:07:43 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.221s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 13:07:43 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.107s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 1.090s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.046s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.054s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.043s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 13:07:44 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 13:07:44 | WARNING  | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.178s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.034s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 13:07:44 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.120s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.024s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 13:07:44 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 2.277s
2025-12-18 13:07:44 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 2.28s
2025-12-18 13:07:44 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.10s, validation_year=2025
2025-12-18 13:07:45 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 13:07:45 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.39s, groups=10
2025-12-18 13:07:45 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 13:07:45 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 13:07:45 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 13:07:45 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 13:07:45 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 13:07:45 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 13:07:45 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.45s, races=5
2025-12-18 13:07:45 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.01s, validation_year=2025
2025-12-18 13:07:45 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 13:07:45 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 13:07:45 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 13:07:45 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 13:07:45 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 13:16:48 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:16:48 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 13:16:48 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 13:16:48 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 13:16:48 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 13:16:48 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 13:16:48 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-18 13:16:48 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-18 13:16:48 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-18 13:16:48 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 13:16:48 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 13:16:48 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.006s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 13:16:48 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.244s, null_city=4304
2025-12-18 13:16:48 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.039s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 13:16:48 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.004s, na_birth_year=0, unique_birth_years=73
2025-12-18 13:16:48 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.147s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 13:16:48 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.070s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 13:16:49 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.854s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 13:16:49 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.043s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 13:16:49 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.051s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 13:16:49 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.033s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 13:16:49 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 13:16:50 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 13:16:50 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 13:16:50 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.148s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 13:16:50 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.027s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 13:16:50 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 13:16:50 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.106s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 13:16:50 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.021s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 13:16:50 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.821s
2025-12-18 13:16:50 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.82s
2025-12-18 13:16:50 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-18 13:16:50 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 13:16:50 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.37s, groups=10
2025-12-18 13:16:50 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 13:16:50 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 13:16:50 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 13:16:51 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 13:16:51 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 13:16:51 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 13:16:51 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.43s, races=5
2025-12-18 13:16:51 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.01s, validation_year=2025
2025-12-18 13:16:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 13:16:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 13:16:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 13:16:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 13:16:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 13:16:51 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 13:16:51 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 13:16:51 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 13:16:51 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.006001710891723633
2025-12-18 13:16:51 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 13:18:32 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:18:32 | INFO     | main                 | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-18 13:18:32 | INFO     | main                 | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-18 13:18:32 | INFO     | main                 | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 13:18:32 | INFO     | DataLoader.data_loader | DataLoader: загружен кэш data_cache.parquet
2025-12-18 13:18:32 | INFO     | main                 | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-18 13:18:32 | INFO     | main                 | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-18 13:18:32 | INFO     | main                 | filter_raw: rows 53142 → 42443, elapsed 0.01s
2025-12-18 13:18:32 | INFO     | main                 | validate_raw: rows 42443 → 42443, elapsed 0.01s
2025-12-18 13:18:32 | INFO     | main                 | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-18 13:18:32 | INFO     | Preprocessor.preprocessor | validate_input_contract:, rows 42443 → 42443, dropped 0, elapsed 0.000s, status=ok
2025-12-18 13:18:32 | INFO     | Preprocessor.preprocessor | ensure_optional_columns:, rows 42443 → 42443, dropped 0, elapsed 0.005s, added_city=False, added_bib_number=False, added_distance_km=False
2025-12-18 13:18:32 | INFO     | Preprocessor.preprocessor | normalize_core_strings:, rows 42443 → 42443, dropped 0, elapsed 0.242s, null_city=4304
2025-12-18 13:18:32 | INFO     | Preprocessor.preprocessor | build_person_base_key:, rows 42443 → 42443, dropped 0, elapsed 0.036s, nunique_ordered_key=23418, nunique_set_key=23239, swap_cases=42437
2025-12-18 13:18:32 | INFO     | Preprocessor.preprocessor | compute_approx_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.005s, na_birth_year=0, unique_birth_years=73
2025-12-18 13:18:32 | INFO     | Preprocessor.preprocessor | stabilize_birth_year:, rows 42443 → 42443, dropped 0, elapsed 0.143s, na_birth_year_stable=0, na_birth_cluster_id=0
2025-12-18 13:18:32 | INFO     | Preprocessor.preprocessor | assign_runner_id:, rows 42443 → 42443, dropped 0, elapsed 0.065s, nunique_runner_id=25037, max_group_size=29, suspicious_multi_start_rows=216, mode=set_key_with_birth_year_stable_and_cluster
2025-12-18 13:18:33 | INFO     | Preprocessor.preprocessor | normalize_city_names:, rows 42443 → 42443, dropped 0, elapsed 0.857s, changed_rows=8327, unique_before=2490, unique_after=2103
2025-12-18 13:18:33 | INFO     | Preprocessor.preprocessor | compute_city_mode_per_runner:, rows 42443 → 42443, dropped 0, elapsed 0.044s, runners_with_single_city=21912, potential_fill_rows=35149
2025-12-18 13:18:33 | INFO     | Preprocessor.preprocessor | fill_city_within_runner:, rows 42443 → 42443, dropped 0, elapsed 0.053s, actual_filled_rows=2071, remaining_na_city=2241
2025-12-18 13:18:33 | INFO     | Preprocessor.preprocessor | split_runner_id_by_city_when_conflicted:, rows 42443 → 42443, dropped 0, elapsed 0.029s, changed_rows=5053, affected_runner_ids=1405
2025-12-18 13:18:33 | INFO     | Preprocessor.preprocessor | after_city_split: event_multi_rows=80
2025-12-18 13:18:34 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority changed winners (top 30):
                                     runner_id  F  M  total winner
                  ALEKSANDR|TARASOV_1984_M1984  1  7      8      M
  IVANOV|IVAN_1985_M1983__CITY_Санкт-Петербург  1  7      8      M
                  ANDREI|OVCHARENKO_1980_M1980  1  4      5      M
                      PAVEL|SMIRNOV_1982_M1982  1  4      5      M
                   BELYAKOV|DMITRII_1985_M1985  1  3      4      M
                 ALEKSEI|TETYUSHKIN_1984_M1984  1  2      3      M
 ALMAZ|GALIAKHMETOV_1974_M1974__CITY_Волгоград  1  2      3      M
                       DANIIL|DANIK_1982_M1982  1  2      3      M
MAMEDOV|VUSAL_1989_M1989__CITY_Санкт-Петербург  1  2      3      M
2025-12-18 13:18:34 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority removed ambiguous (top 30):
                 runner_id  F  M  total winner
DMITRII|SOZONOV_1970_M1970  1  1      2   <NA>
 IRINA|LEBEDEVA_1985_M1985  1  1      2   <NA>
  MAKSIM|SINKIN_1983_M1983  1  1      2   <NA>
2025-12-18 13:18:34 | INFO     | Preprocessor.preprocessor | fix_gender_by_majority:, rows 42443 → 42437, dropped 6, elapsed 0.151s, removed_rows=6, removed_runner_ids=3, changed_rows=9
2025-12-18 13:18:34 | INFO     | Preprocessor.preprocessor | deduplicate_strict:, rows 42437 → 42437, dropped 0, elapsed 0.025s, removed_rows=0, duplicate_groups=0, bib_fill_rate=1.000, bib_used=True, key_cols=runner_id|race_id|year|time_seconds|bib_number
2025-12-18 13:18:34 | WARNING  | Preprocessor.preprocessor | drop_ambiguous_event_multi: leftover event_multi rows=6
                          runner_id       race_id  year  bib_number  city  age  time_seconds
19534  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        4735  <NA>   40       17460.0
19583  ALEKSANDR|KALININ_1982_M1981  Дорога жизни  2022        3697  <NA>   39       17740.0
18619      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        4771  <NA>   45       13359.0
19223      ANDREI|PETROV_1977_M1976  Дорога жизни  2022        5027  <NA>   45       15931.0
18492      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4121  <NA>   34       12516.0
19033      ANDREI|PETROV_1987_M1987  Дорога жизни  2022        4992  <NA>   34       15088.0
2025-12-18 13:18:34 | INFO     | Preprocessor.preprocessor | drop_ambiguous_event_multi:, rows 42437 → 42357, dropped 80, elapsed 0.102s, removed_rows=80, removed_ambiguous=74, removed_leftover=6, removed_share=0.001885
2025-12-18 13:18:34 | INFO     | Preprocessor.preprocessor | add_features:, rows 42357 → 42357, dropped 0, elapsed 0.019s, age_center=35.0, age_scale=10.0, age_min_global=18.0, age_max_global=80.0
2025-12-18 13:18:34 | INFO     | Preprocessor.preprocessor | preprocess_total:, rows 42443 → 42357, dropped 86, elapsed 1.797s
2025-12-18 13:18:34 | INFO     | main                 | preprocess: rows 42443 → 42357, elapsed 1.80s
2025-12-18 13:18:34 | INFO     | main                 | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-18 13:18:34 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 13:18:34 | INFO     | main                 | build_trace_references: rows 36205 → 10, elapsed 0.34s, groups=10
2025-12-18 13:18:34 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 13:18:34 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 13:18:34 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 13:18:35 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 13:18:35 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 13:18:35 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 13:18:35 | INFO     | main                 | build_age_references: rows 36205 → 335, elapsed 0.40s, races=5
2025-12-18 13:18:35 | INFO     | main                 | fit_age_model: rows 42357 → 36205, elapsed 0.00s, validation_year=2025
2025-12-18 13:18:35 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 13:18:35 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 13:18:35 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 13:18:35 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 13:18:35 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 13:18:35 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 13:18:35 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 13:18:35 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 13:18:35 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005967617034912109
2025-12-18 13:18:35 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 13:22:50 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:22:52 | INFO     | trace_reference_builder | ReferenceBuilder: построено 10 эталонов
2025-12-18 13:22:52 | INFO     | age_reference_builder | AgeReferenceBuilder config: min_group_size=10, bootstrap_samples=500, random_seed=456
2025-12-18 13:22:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 93 возрастных медиан
2025-12-18 13:22:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 92 возрастных медиан
2025-12-18 13:22:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 89 возрастных медиан
2025-12-18 13:22:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 52 возрастных медиан
2025-12-18 13:22:52 | INFO     | age_reference_builder | AgeReferenceBuilder: построено 9 возрастных медиан
2025-12-18 13:22:53 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 13:22:53 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 13:22:53 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 13:22:53 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 13:22:53 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 13:22:53 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 13:22:53 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 13:22:53 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 13:22:53 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.00600743293762207
2025-12-18 13:22:53 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 13:24:37 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:24:40 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 13:24:40 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 13:24:40 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 13:24:40 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 13:24:40 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 13:24:40 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 13:24:40 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 13:24:40 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 13:24:40 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.004991054534912109
2025-12-18 13:24:40 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 13:48:51 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:48:55 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 13:48:55 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 13:48:55 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 13:48:55 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 13:48:55 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 13:48:55 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 13:48:55 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 13:48:55 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 13:48:55 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0049991607666015625
2025-12-18 13:48:55 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 13:53:48 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:53:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 13:53:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 13:53:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 13:53:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 13:53:51 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 13:53:51 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 13:53:51 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 13:53:51 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 13:53:51 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0060002803802490234
2025-12-18 13:53:51 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 13:57:25 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:57:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 13:57:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 13:57:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 13:57:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 13:57:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 13:57:28 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 13:57:28 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 13:57:28 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 13:57:28 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.004999637603759766
2025-12-18 13:57:28 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 13:57:28 | INFO     | root                 | === Логирование включено ===
2025-12-18 13:57:31 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 14:11:28 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:11:31 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 14:11:31 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 14:11:31 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 14:11:31 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 14:11:31 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 14:11:31 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 14:11:31 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 14:11:31 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 14:11:31 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.006006002426147461
2025-12-18 14:11:31 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 14:13:25 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:13:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age_min_global/age_max_global: 18.0 80.0
2025-12-18 14:13:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: age range: 18.0 80.0
2025-12-18 14:13:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 14:13:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 14:13:28 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 14:13:28 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 14:13:28 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 14:13:28 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 14:13:28 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005001068115234375
2025-12-18 14:13:28 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 14:17:32 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:17:35 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(train_frame['x']) range: -1.7 4.5
2025-12-18 14:17:35 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: x_std(recomputed) range: -1.7 4.5
2025-12-18 14:17:35 | INFO     | spline_model.spline_tests.test_real_data | DEBUG: max_abs_diff(x_std frame vs recomputed): 0.0
2025-12-18 14:17:35 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 14:17:35 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 14:17:35 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 14:17:35 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.006203413009643555
2025-12-18 14:17:35 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 14:17:49 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:17:52 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 14:17:52 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 14:17:52 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 14:17:52 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0060007572174072266
2025-12-18 14:17:52 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 14:25:08 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:25:20 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:25:23 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 14:27:03 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:27:06 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 14:27:06 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 14:27:06 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 14:27:06 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 14:27:06 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005656242370605469
2025-12-18 14:27:06 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 14:31:09 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:31:14 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 14:53:57 | INFO     | root                 | === Логирование включено ===
2025-12-18 14:54:00 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 14:54:00 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 14:54:00 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 14:54:00 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 14:54:00 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0059986114501953125
2025-12-18 14:54:00 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:03:30 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:03:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:03:33 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:03:33 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:03:33 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:03:33 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0049991607666015625
2025-12-18 15:03:33 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:06:04 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:06:07 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:06:07 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:06:07 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:06:07 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:06:07 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005005836486816406
2025-12-18 15:06:07 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:06:07 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:06:09 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:06:09 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:06:09 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:06:12 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:08:50 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:08:54 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:08:54 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:08:54 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:08:54 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:08:54 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0060007572174072266
2025-12-18 15:08:54 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:08:54 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:08:57 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:08:57 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:08:57 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:09:00 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:10:06 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:10:09 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:10:09 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:10:09 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:10:09 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:10:09 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005999088287353516
2025-12-18 15:10:09 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:10:09 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:10:12 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:10:12 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:10:12 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:10:15 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:13:46 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:15:24 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:15:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:15:42 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:15:42 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:15:42 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:15:42 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.007961750030517578
2025-12-18 15:15:42 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:15:42 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:16:00 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:16:00 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:16:00 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:16:21 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:16:21 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:16:21 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.942890293094024e-16
2025-12-18 15:36:40 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:36:53 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:36:53 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:36:53 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:36:53 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:36:53 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0055081844329833984
2025-12-18 15:36:53 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:36:53 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:36:53 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:36:53 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.942890293094024e-16
2025-12-18 15:38:46 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:38:59 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:39:18 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:39:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:39:32 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:39:32 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:39:32 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:39:32 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.006000041961669922
2025-12-18 15:39:32 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:39:32 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:40:12 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:40:27 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:40:27 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:40:27 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:40:27 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:40:27 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.008002042770385742
2025-12-18 15:40:27 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:40:27 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:40:27 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:40:27 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.942890293094024e-16
2025-12-18 15:51:18 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:51:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:51:32 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:51:32 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:51:32 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:51:32 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.006002187728881836
2025-12-18 15:51:32 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:51:32 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:51:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:51:32 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.942890293094024e-16
2025-12-18 15:52:39 | INFO     | root                 | === Логирование включено ===
2025-12-18 15:53:23 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 15:53:23 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 15:53:23 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 15:53:23 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 15:53:23 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005791902542114258
2025-12-18 15:53:23 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 15:53:23 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 15:53:23 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:06:06 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:06:22 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:06:22 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 16:06:22 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 16:06:22 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.035s
2025-12-18 16:06:22 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 16:06:22 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 16:06:22 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 16:06:22 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.00599980354309082
2025-12-18 16:06:22 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 16:06:22 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 16:06:54 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:07:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:07:36 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 16:07:36 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 16:07:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.058s
2025-12-18 16:07:36 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 16:07:36 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 16:07:36 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 16:07:36 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005031108856201172
2025-12-18 16:07:36 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 16:07:36 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 16:09:10 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:09:25 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:09:25 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 16:09:25 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 16:09:25 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.032s
2025-12-18 16:09:25 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 16:09:25 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 16:09:25 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 16:09:25 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.006000995635986328
2025-12-18 16:09:25 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 16:09:25 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 16:23:20 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:23:34 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:24:20 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:25:43 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:26:02 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:26:32 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:26:46 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:26:46 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 16:26:46 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 16:26:46 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.029s
2025-12-18 16:26:46 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 16:26:46 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 16:26:46 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 16:26:46 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.008003950119018555
2025-12-18 16:26:46 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 16:27:25 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:27:39 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:27:39 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 16:27:39 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 16:27:39 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.034s
2025-12-18 16:27:39 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 16:27:39 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 16:27:39 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 16:27:39 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.007891416549682617
2025-12-18 16:27:39 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 16:27:39 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 16:27:50 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:28:04 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:28:04 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 16:28:04 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 16:28:04 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.028s
2025-12-18 16:28:04 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 16:28:04 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 16:28:04 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 16:28:04 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.004003763198852539
2025-12-18 16:28:04 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 16:28:04 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 16:29:25 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:30:12 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:30:27 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 16:30:27 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 16:30:27 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 15.794s
2025-12-18 16:30:27 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 16:30:27 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 16:30:27 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 16:30:27 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005000114440917969
2025-12-18 16:30:27 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 16:30:27 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 16:30:34 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:30:46 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:32:26 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.942890293094024e-16
2025-12-18 16:33:17 | INFO     | root                 | === Логирование включено ===
2025-12-18 16:33:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:33:32 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 16:33:32 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 16:33:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.028s
2025-12-18 16:33:32 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 16:33:32 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 16:33:32 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 16:33:32 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005999326705932617
2025-12-18 16:33:32 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 16:33:32 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 16:33:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=GCV
2025-12-18 16:33:32 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.942890293094024e-16
2025-12-18 17:17:48 | INFO     | root                 | === Логирование включено ===
2025-12-18 17:18:01 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:18:01 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 17:18:01 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 17:18:01 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.031s
2025-12-18 17:18:01 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 17:18:01 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 17:18:01 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 17:18:01 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005002260208129883
2025-12-18 17:18:01 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 17:18:01 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 17:18:01 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:18:01 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 17:21:09 | INFO     | root                 | === Логирование включено ===
2025-12-18 17:21:22 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:21:22 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 17:21:22 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 17:21:22 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.031s
2025-12-18 17:21:22 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 17:21:22 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 17:21:22 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 17:21:22 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005002737045288086
2025-12-18 17:21:22 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 17:21:22 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 17:21:22 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:21:22 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 17:27:55 | INFO     | root                 | === Логирование включено ===
2025-12-18 17:28:09 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:28:09 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 17:28:09 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 17:28:09 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.085s
2025-12-18 17:28:10 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 17:28:10 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 17:28:10 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.012161731719970703
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 4.163336342344337e-17
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.37058770309740496, 0.3161753814812581, 4.163336342344337e-17, 0.3641751600443561, 0.41681149522844807, 0.5900478343941786]
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.3647255880974632 h(50)=0.3641751600443561 h(70)=0.500083114220151
2025-12-18 17:28:10 | WARNING  | spline_model.spline_tests.test_real_data | predict_h shape warning: h(50) <= h(30), форма может быть необычной
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.045s
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-18 17:28:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 17:28:10 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-18 18:30:28 | INFO     | root                 | === Логирование включено ===
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.030s
2025-12-18 18:30:42 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 18:30:42 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 18:30:42 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.006003379821777344
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 4.163336342344337e-17
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.37058770309740496, 0.3161753814812581, 4.163336342344337e-17, 0.3641751600443561, 0.41681149522844807, 0.5900478343941786]
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.3647255880974632 h(50)=0.3641751600443561 h(70)=0.500083114220151
2025-12-18 18:30:42 | WARNING  | spline_model.spline_tests.test_real_data | predict_h shape warning: h(50) <= h(30), форма может быть необычной
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.033s
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-18 18:30:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:30:42 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-18 18:55:04 | INFO     | root                 | === Логирование включено ===
2025-12-18 18:55:20 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:55:20 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 18:55:20 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 18:55:20 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.029s
2025-12-18 18:55:20 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 18:55:20 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 18:55:20 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 18:55:20 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0074214935302734375
2025-12-18 18:55:20 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 18:55:20 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 18:55:20 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 18:55:20 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 18:55:20 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:21 | INFO     | root                 | === Логирование включено ===
2025-12-18 19:09:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:09:36 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:09:36 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:09:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.034s
2025-12-18 19:09:36 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 19:09:36 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 19:09:36 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 19:09:36 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.008627176284790039
2025-12-18 19:09:36 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 19:09:36 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 19:09:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:09:36 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 19:09:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:37 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:39 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 3.469446951953614e-17
2025-12-18 19:09:39 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:40 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.3721039153578647, 0.3162912755261102, 2.7755575615628914e-17, 0.3636525999344303, 0.4162976562775311, 0.5944182965275535]
2025-12-18 19:09:40 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:41 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-18 19:09:41 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:42 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.36456524411572894 h(50)=0.3636525999344303 h(70)=0.4990255949403426
2025-12-18 19:09:42 | WARNING  | spline_model.spline_tests.test_real_data | predict_h shape warning: h(50) <= h(30), форма может быть необычной
2025-12-18 19:09:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:42 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:09:43 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:09:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.143s
2025-12-18 19:09:43 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-18 19:09:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:09:44 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-18 19:12:00 | INFO     | root                 | === Логирование включено ===
2025-12-18 19:12:14 | INFO     | root                 | === Логирование включено ===
2025-12-18 19:12:31 | INFO     | root                 | === Логирование включено ===
2025-12-18 19:12:45 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:12:45 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:12:45 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:12:45 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.029s
2025-12-18 19:12:45 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 19:12:45 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 19:12:45 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 19:12:45 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.004999399185180664
2025-12-18 19:12:45 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 19:12:45 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 19:12:45 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:12:45 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 19:12:45 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:12:46 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:12:47 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 4.163336342344337e-17
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:12:47 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.37058770309740496, 0.3161753814812581, 4.163336342344337e-17, 0.3641751600443561, 0.41681149522844807, 0.5900478343941786]
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:12:47 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:12:47 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.3647255880974632 h(50)=0.3641751600443561 h(70)=0.500083114220151
2025-12-18 19:12:47 | WARNING  | spline_model.spline_tests.test_real_data | predict_h shape warning: h(50) <= h(30), форма может быть необычной
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.029s
2025-12-18 19:12:47 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-18 19:12:47 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:12:47 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-18 19:41:37 | INFO     | root                 | === Логирование включено ===
2025-12-18 19:41:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:41:50 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:41:50 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:41:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.029s
2025-12-18 19:41:50 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 19:41:50 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 19:41:50 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 19:41:50 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.004999876022338867
2025-12-18 19:41:50 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 19:41:51 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 19:41:51 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:41:51 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 19:41:51 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:41:51 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:41:52 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:41:52 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 4.163336342344337e-17
2025-12-18 19:41:52 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:41:52 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.37058770309740496, 0.3161753814812581, 4.163336342344337e-17, 0.3641751600443561, 0.41681149522844807, 0.5900478343941786]
2025-12-18 19:41:52 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:41:52 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-18 19:41:52 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:41:52 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.3647255880974632 h(50)=0.3641751600443561 h(70)=0.500083114220151
2025-12-18 19:41:52 | WARNING  | spline_model.spline_tests.test_real_data | predict_h shape warning: h(50) <= h(30), форма может быть необычной
2025-12-18 19:41:52 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:41:52 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:41:52 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:41:53 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.032s
2025-12-18 19:41:53 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-18 19:41:53 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:41:53 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-18 19:44:16 | INFO     | root                 | === Логирование включено ===
2025-12-18 19:44:31 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:44:31 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:44:31 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:44:31 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.032s
2025-12-18 19:44:31 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 19:44:31 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 19:44:31 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 19:44:31 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.005261659622192383
2025-12-18 19:44:31 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 19:44:31 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 19:44:31 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:44:31 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 19:44:31 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:44:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:44:33 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 4.163336342344337e-17
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:44:33 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.37058770309740496, 0.3161753814812581, 4.163336342344337e-17, 0.3641751600443561, 0.41681149522844807, 0.5900478343941786]
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:44:33 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:44:33 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.3647255880974632 h(50)=0.3641751600443561 h(70)=0.500083114220151
2025-12-18 19:44:33 | WARNING  | spline_model.spline_tests.test_real_data | predict_h shape warning: h(50) <= h(30), форма может быть необычной
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.034s
2025-12-18 19:44:33 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-18 19:44:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:44:33 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-18 19:59:29 | INFO     | root                 | === Логирование включено ===
2025-12-18 19:59:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:59:42 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:59:42 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:59:42 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.028s
2025-12-18 19:59:42 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 19:59:42 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 19:59:42 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 19:59:42 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0055446624755859375
2025-12-18 19:59:42 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 19:59:43 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 19:59:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:59:43 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 19:59:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:59:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:59:44 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 4.163336342344337e-17
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:59:44 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.37058770309740496, 0.3161753814812581, 4.163336342344337e-17, 0.3641751600443561, 0.41681149522844807, 0.5900478343941786]
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:59:44 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:59:44 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.3647255880974632 h(50)=0.3641751600443561 h(70)=0.500083114220151
2025-12-18 19:59:44 | WARNING  | spline_model.spline_tests.test_real_data | predict_h shape warning: h(50) <= h(30), форма может быть необычной
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.030s
2025-12-18 19:59:44 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-18 19:59:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 19:59:44 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-18 20:05:58 | INFO     | root                 | === Логирование включено ===
2025-12-18 20:06:14 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 20:06:14 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 20:06:14 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 20:06:14 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.042s
2025-12-18 20:06:14 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-18 20:06:14 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-18 20:06:14 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-18 20:06:14 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.007000446319580078
2025-12-18 20:06:14 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-18 20:06:14 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-18 20:06:14 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 20:06:14 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=1.6653345369377348e-16
2025-12-18 20:06:14 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 20:06:15 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 20:06:16 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 4.163336342344337e-17
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 20:06:16 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.37058770309740496, 0.3161753814812581, 4.163336342344337e-17, 0.3641751600443561, 0.41681149522844807, 0.5900478343941786]
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 20:06:16 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 20:06:16 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.3647255880974632 h(50)=0.3641751600443561 h(70)=0.500083114220151
2025-12-18 20:06:16 | WARNING  | spline_model.spline_tests.test_real_data | predict_h shape warning: h(50) <= h(30), форма может быть необычной
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.031s
2025-12-18 20:06:16 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-18 20:06:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-18 20:06:16 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-19 13:48:22 | INFO     | root                 | === Логирование включено ===
2025-12-19 13:48:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 13:48:36 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-19 13:48:36 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-19 13:48:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.030s
2025-12-19 13:48:36 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-19 13:48:36 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-19 13:48:36 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-19 13:48:36 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.004999399185180664
2025-12-19 13:48:36 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-19 13:48:36 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-19 13:48:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 13:48:36 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=9.540979117872439e-18
2025-12-19 13:48:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-19 13:48:37 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 13:48:38 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 5.854691731421724e-18
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 13:48:38 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.10126253827103773, 0.017383181492263585, 5.637851296924623e-18, 0.04213875163047208, 0.15288711757017376, 0.4210230113866945]
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 13:48:38 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 13:48:38 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.0038777356165400328 h(50)=0.04213875163047208 h(70)=0.2204160068904587
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.030s
2025-12-19 13:48:38 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-19 13:48:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 13:48:38 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
