2025-12-19 17:31:34 | INFO     | root                 | === Логирование включено ===
2025-12-19 17:31:34 | INFO     | spline_model.spline_tests.test_real_data | Строим модель!
2025-12-19 17:31:34 | INFO     | MarathonAgeModel     | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-19 17:31:34 | INFO     | MarathonAgeModel     | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-19 17:31:34 | INFO     | MarathonAgeModel     | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-19 17:31:35 | INFO     | MarathonAgeModel     | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-19 17:31:35 | INFO     | MarathonAgeModel     | load_data: rows 0 → 53142, elapsed 0.21s
2025-12-19 17:31:35 | INFO     | MarathonAgeModel     | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-19 17:31:35 | INFO     | MarathonAgeModel     | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-19 17:31:35 | INFO     | MarathonAgeModel     | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-19 17:31:36 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.010s)
2025-12-19 17:31:37 | INFO     | MarathonAgeModel     | preprocess: rows 42443 → 42357, elapsed 2.01s
2025-12-19 17:31:37 | INFO     | MarathonAgeModel     | build_train_frame_loy: rows 42357 → 36205, elapsed 0.06s, validation_year=2025
2025-12-19 17:31:37 | INFO     | MarathonAgeModel     | build_trace_references: rows 36205 → 10, elapsed 0.38s, groups=10
2025-12-19 17:31:48 | INFO     | MarathonAgeModel     | build_age_references: rows 36205 → 335, elapsed 0.40s, races=5
2025-12-19 17:31:48 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:48 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-19 17:31:48 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-19 17:31:48 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.034s
2025-12-19 17:31:48 | INFO     | MarathonAgeModel     | fit_age_model: rows 42357 → 36205, elapsed 0.08s, validation_year=2025
2025-12-19 17:31:48 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-19 17:31:48 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-19 17:31:48 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-19 17:31:48 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0049991607666015625
2025-12-19 17:31:48 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-19 17:31:48 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-19 17:31:48 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:48 | WARNING  | spline_model.compute_tau2_bar | compute_tau2_bar: reference_variance not in trace_references, using tau2_bar=0.0 for gender=M
2025-12-19 17:31:48 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=9.540979117872439e-18
2025-12-19 17:31:48 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-19 17:31:49 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 5.854691731421724e-18
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.10126253827103773, 0.017383181492263585, 5.637851296924623e-18, 0.04213875163047208, 0.15288711757017376, 0.4210230113866945]
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.0038777356165400328 h(50)=0.04213875163047208 h(70)=0.2204160068904587
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.034s
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=M, tau2_bar=0.000000
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=F, tau2_bar=0.000000
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=M, sigma2_reml=0.000000, tau2_bar=0.000000, sigma2_use=0.000000
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=F, sigma2_reml=0.000000, tau2_bar=0.000000, sigma2_use=0.000000
2025-12-19 17:31:50 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:31:50 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar with missing references: OK (tau2_bar=0.0)
2025-12-19 17:32:24 | INFO     | root                 | === Логирование включено ===
2025-12-19 17:32:24 | INFO     | spline_model.spline_tests.test_real_data | Строим модель!
2025-12-19 17:32:24 | INFO     | MarathonAgeModel     | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-19 17:32:24 | INFO     | MarathonAgeModel     | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-19 17:32:24 | INFO     | MarathonAgeModel     | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-19 17:32:25 | INFO     | MarathonAgeModel     | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-19 17:32:25 | INFO     | MarathonAgeModel     | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-19 17:32:25 | INFO     | MarathonAgeModel     | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-19 17:32:25 | INFO     | MarathonAgeModel     | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-19 17:32:25 | INFO     | MarathonAgeModel     | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-19 17:32:28 | INFO     | root                 | === Логирование включено ===
2025-12-19 17:32:28 | INFO     | spline_model.spline_tests.test_real_data | Строим модель!
2025-12-19 17:32:28 | INFO     | MarathonAgeModel     | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-19 17:32:28 | INFO     | MarathonAgeModel     | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-19 17:32:28 | INFO     | MarathonAgeModel     | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-19 17:32:28 | INFO     | MarathonAgeModel     | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-19 17:32:28 | INFO     | MarathonAgeModel     | load_data: rows 0 → 53142, elapsed 0.08s
2025-12-19 17:32:28 | INFO     | MarathonAgeModel     | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-19 17:32:28 | INFO     | MarathonAgeModel     | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-19 17:32:29 | INFO     | MarathonAgeModel     | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-19 17:32:30 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-19 17:32:31 | INFO     | MarathonAgeModel     | preprocess: rows 42443 → 42357, elapsed 2.16s
2025-12-19 17:32:31 | INFO     | MarathonAgeModel     | build_train_frame_loy: rows 42357 → 36205, elapsed 0.08s, validation_year=2025
2025-12-19 17:32:31 | INFO     | MarathonAgeModel     | build_trace_references: rows 36205 → 10, elapsed 0.43s, groups=10
2025-12-19 17:32:42 | INFO     | MarathonAgeModel     | build_age_references: rows 36205 → 335, elapsed 0.41s, races=5
2025-12-19 17:32:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:43 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-19 17:32:43 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-19 17:32:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.032s
2025-12-19 17:32:43 | INFO     | MarathonAgeModel     | fit_age_model: rows 42357 → 36205, elapsed 0.07s, validation_year=2025
2025-12-19 17:32:43 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-19 17:32:43 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-19 17:32:43 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-19 17:32:43 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36205, 12) elapsed_sec=0.0049991607666015625
2025-12-19 17:32:43 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-19 17:32:43 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622636.8699299931 max_abs_constraint=5.329070518200751e-15
2025-12-19 17:32:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:43 | WARNING  | spline_model.compute_tau2_bar | compute_tau2_bar: reference_variance not in trace_references, using tau2_bar=0.0 for gender=M
2025-12-19 17:32:43 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=9.540979117872439e-18
2025-12-19 17:32:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-19 17:32:43 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 5.854691731421724e-18
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.10126253827103773, 0.017383181492263585, 5.637851296924623e-18, 0.04213875163047208, 0.15288711757017376, 0.4210230113866945]
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.0038777356165400328 h(50)=0.04213875163047208 h(70)=0.2204160068904587
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29450
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 0.034s
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29450 K_raw=12 K_cent=10
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=M, tau2_bar=0.000000
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=F, tau2_bar=0.000000
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=M, sigma2_reml=0.000000, tau2_bar=0.000000, sigma2_use=0.000000
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=F, sigma2_reml=0.000000, tau2_bar=0.000000, sigma2_use=0.000000
2025-12-19 17:32:44 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=FIXED
2025-12-19 17:32:44 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar with missing references: OK (tau2_bar=0.0)
2025-12-22 15:42:47 | INFO     | root                 | === Логирование включено ===
2025-12-22 15:42:47 | INFO     | spline_model.spline_tests.test_real_data | Строим модель!
2025-12-22 15:42:47 | INFO     | MarathonAgeModel     | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-22 15:42:47 | INFO     | MarathonAgeModel     | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-22 15:42:47 | INFO     | MarathonAgeModel     | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 15:42:48 | INFO     | MarathonAgeModel     | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 15:42:48 | INFO     | MarathonAgeModel     | load_data: rows 0 → 53142, elapsed 0.33s
2025-12-22 15:42:48 | INFO     | MarathonAgeModel     | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-22 15:42:48 | INFO     | MarathonAgeModel     | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-22 15:42:48 | INFO     | MarathonAgeModel     | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-22 15:42:49 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.007s)
2025-12-22 15:42:50 | INFO     | MarathonAgeModel     | preprocess: rows 42443 → 42355, elapsed 2.30s
2025-12-22 15:42:50 | INFO     | MarathonAgeModel     | build_train_frame_loy: rows 42355 → 36203, elapsed 0.08s, validation_year=2025
2025-12-22 15:42:50 | INFO     | MarathonAgeModel     | build_trace_references: rows 36203 → 10, elapsed 0.47s, groups=10
2025-12-22 15:43:02 | INFO     | MarathonAgeModel     | build_age_references: rows 36203 → 335, elapsed 0.45s, races=5
2025-12-22 15:43:02 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:43:02 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 15:43:03 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 15:43:03 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.166s
2025-12-22 15:43:03 | INFO     | MarathonAgeModel     | fit_age_model: rows 42355 → 36203, elapsed 1.21s, validation_year=2025
2025-12-22 15:43:03 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-22 15:43:03 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-22 15:43:03 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-22 15:43:03 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36203, 12) elapsed_sec=0.005998849868774414
2025-12-22 15:43:03 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-22 15:43:03 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622529.0077779426 max_abs_constraint=4.440892098500626e-15
2025-12-22 15:43:03 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:43:04 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=7.37257477290143e-18
2025-12-22 15:43:04 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:43:05 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:43:07 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:43:07 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 7.15573433840433e-18
2025-12-22 15:43:07 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:43:08 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.09707268580535326, 0.023791916323061477, 7.37257477290143e-18, 0.030513662938738854, 0.1307586767555667, 0.3781126958275823]
2025-12-22 15:43:08 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:43:09 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-22 15:43:09 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:43:11 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.009378238281431557 h(50)=0.030513662938738854 h(70)=0.19402493525727005
2025-12-22 15:43:11 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:10 | INFO     | root                 | === Логирование включено ===
2025-12-22 15:59:10 | INFO     | spline_model.spline_tests.test_real_data | Строим модель!
2025-12-22 15:59:10 | INFO     | MarathonAgeModel     | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-22 15:59:10 | INFO     | MarathonAgeModel     | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-22 15:59:10 | INFO     | MarathonAgeModel     | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 15:59:10 | INFO     | MarathonAgeModel     | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 15:59:10 | INFO     | MarathonAgeModel     | load_data: rows 0 → 53142, elapsed 0.11s
2025-12-22 15:59:10 | INFO     | MarathonAgeModel     | filter_raw: rows 53142 → 42443, elapsed 0.03s
2025-12-22 15:59:10 | INFO     | MarathonAgeModel     | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-22 15:59:10 | INFO     | MarathonAgeModel     | add_row_id: rows 42443 → 42443, elapsed 0.02s
2025-12-22 15:59:12 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.008s)
2025-12-22 15:59:13 | INFO     | MarathonAgeModel     | preprocess: rows 42443 → 42355, elapsed 2.58s
2025-12-22 15:59:13 | INFO     | MarathonAgeModel     | build_train_frame_loy: rows 42355 → 36203, elapsed 0.09s, validation_year=2025
2025-12-22 15:59:13 | INFO     | MarathonAgeModel     | build_trace_references: rows 36203 → 10, elapsed 0.51s, groups=10
2025-12-22 15:59:25 | INFO     | MarathonAgeModel     | build_age_references: rows 36203 → 335, elapsed 0.45s, races=5
2025-12-22 15:59:25 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:25 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 15:59:26 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 15:59:27 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.139s
2025-12-22 15:59:27 | INFO     | MarathonAgeModel     | fit_age_model: rows 42355 → 36203, elapsed 1.19s, validation_year=2025
2025-12-22 15:59:27 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-22 15:59:27 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-22 15:59:27 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-22 15:59:27 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36203, 12) elapsed_sec=0.005999326705932617
2025-12-22 15:59:27 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-22 15:59:27 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622529.0077779426 max_abs_constraint=4.440892098500626e-15
2025-12-22 15:59:27 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:27 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=7.37257477290143e-18
2025-12-22 15:59:27 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:29 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:30 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:31 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 7.15573433840433e-18
2025-12-22 15:59:31 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:32 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.09707268580535326, 0.023791916323061477, 7.37257477290143e-18, 0.030513662938738854, 0.1307586767555667, 0.3781126958275823]
2025-12-22 15:59:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:33 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-22 15:59:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:33 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.009378238281431557 h(50)=0.030513662938738854 h(70)=0.19402493525727005
2025-12-22 15:59:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:33 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 15:59:34 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 15:59:35 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.205s
2025-12-22 15:59:35 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-22 15:59:35 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:35 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29448 K_raw=12 K_cent=10
2025-12-22 15:59:35 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=M, tau2_bar=0.000030
2025-12-22 15:59:35 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=F, tau2_bar=0.000248
2025-12-22 15:59:35 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=M, sigma2_reml=0.028492, tau2_bar=0.000030, sigma2_use=0.028462
2025-12-22 15:59:35 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=F, sigma2_reml=0.027064, tau2_bar=0.000248, sigma2_use=0.026816
2025-12-22 15:59:35 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 15:59:36 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar with missing references: OK (tau2_bar=0.0)
2025-12-22 16:02:37 | INFO     | root                 | === Логирование включено ===
2025-12-22 16:02:37 | INFO     | spline_model.spline_tests.test_real_data | Строим модель!
2025-12-22 16:02:37 | INFO     | MarathonAgeModel     | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-22 16:02:37 | INFO     | MarathonAgeModel     | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-22 16:02:37 | INFO     | MarathonAgeModel     | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 16:02:37 | INFO     | MarathonAgeModel     | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 16:02:37 | INFO     | MarathonAgeModel     | load_data: rows 0 → 53142, elapsed 0.07s
2025-12-22 16:02:37 | INFO     | MarathonAgeModel     | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-22 16:02:37 | INFO     | MarathonAgeModel     | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-22 16:02:37 | INFO     | MarathonAgeModel     | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-22 16:02:39 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-22 16:02:40 | INFO     | MarathonAgeModel     | preprocess: rows 42443 → 42355, elapsed 2.12s
2025-12-22 16:02:40 | INFO     | MarathonAgeModel     | build_train_frame_loy: rows 42355 → 36203, elapsed 0.07s, validation_year=2025
2025-12-22 16:02:40 | INFO     | MarathonAgeModel     | build_trace_references: rows 36203 → 10, elapsed 0.34s, groups=10
2025-12-22 16:02:52 | INFO     | MarathonAgeModel     | build_age_references: rows 36203 → 335, elapsed 0.43s, races=5
2025-12-22 16:02:52 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:02:52 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 16:02:53 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 16:02:53 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.157s
2025-12-22 16:02:53 | INFO     | MarathonAgeModel     | fit_age_model: rows 42355 → 36203, elapsed 1.20s, validation_year=2025
2025-12-22 16:02:53 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-22 16:02:53 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-22 16:02:53 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-22 16:02:53 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36203, 12) elapsed_sec=0.004999637603759766
2025-12-22 16:02:53 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-22 16:02:53 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622529.0077779426 max_abs_constraint=4.440892098500626e-15
2025-12-22 16:02:53 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:02:54 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=7.37257477290143e-18
2025-12-22 16:02:54 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:02:55 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:02:56 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:02:57 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 7.15573433840433e-18
2025-12-22 16:02:57 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:02:58 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.09707268580535326, 0.023791916323061477, 7.37257477290143e-18, 0.030513662938738854, 0.1307586767555667, 0.3781126958275823]
2025-12-22 16:02:58 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:02:59 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-22 16:02:59 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:03:00 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.009378238281431557 h(50)=0.030513662938738854 h(70)=0.19402493525727005
2025-12-22 16:03:00 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:03:00 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 16:03:01 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 16:03:01 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.078s
2025-12-22 16:03:01 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-22 16:03:01 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:03:02 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29448 K_raw=12 K_cent=10
2025-12-22 16:03:02 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=M, tau2_bar=0.000030
2025-12-22 16:03:02 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=F, tau2_bar=0.000248
2025-12-22 16:03:02 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=M, sigma2_reml=0.028492, tau2_bar=0.000030, sigma2_use=0.028462
2025-12-22 16:03:02 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=F, sigma2_reml=0.027064, tau2_bar=0.000248, sigma2_use=0.026816
2025-12-22 16:03:02 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:03:03 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar with missing references: OK (tau2_bar=0.0)
2025-12-22 16:08:54 | INFO     | root                 | === Логирование включено ===
2025-12-22 16:08:54 | INFO     | spline_model.spline_tests.test_real_data | Строим модель!
2025-12-22 16:08:54 | INFO     | MarathonAgeModel     | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-22 16:08:54 | INFO     | MarathonAgeModel     | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-22 16:08:54 | INFO     | MarathonAgeModel     | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 16:08:54 | INFO     | MarathonAgeModel     | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 16:08:54 | INFO     | MarathonAgeModel     | load_data: rows 0 → 53142, elapsed 0.08s
2025-12-22 16:08:54 | INFO     | MarathonAgeModel     | filter_raw: rows 53142 → 42443, elapsed 0.03s
2025-12-22 16:08:54 | INFO     | MarathonAgeModel     | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-22 16:08:54 | INFO     | MarathonAgeModel     | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-22 16:08:56 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-22 16:08:56 | INFO     | MarathonAgeModel     | preprocess: rows 42443 → 42355, elapsed 2.07s
2025-12-22 16:08:56 | INFO     | MarathonAgeModel     | build_train_frame_loy: rows 42355 → 36203, elapsed 0.05s, validation_year=2025
2025-12-22 16:08:56 | INFO     | MarathonAgeModel     | build_trace_references: rows 36203 → 10, elapsed 0.36s, groups=10
2025-12-22 16:09:07 | INFO     | MarathonAgeModel     | build_age_references: rows 36203 → 335, elapsed 0.39s, races=5
2025-12-22 16:09:08 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:08 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 16:09:08 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 16:09:09 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.040s
2025-12-22 16:09:09 | INFO     | MarathonAgeModel     | fit_age_model: rows 42355 → 36203, elapsed 1.08s, validation_year=2025
2025-12-22 16:09:09 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-22 16:09:09 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-22 16:09:09 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-22 16:09:09 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36203, 12) elapsed_sec=0.006000518798828125
2025-12-22 16:09:09 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-22 16:09:09 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622529.0077779426 max_abs_constraint=4.440892098500626e-15
2025-12-22 16:09:09 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:09 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=7.37257477290143e-18
2025-12-22 16:09:09 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:10 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:11 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:12 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 7.15573433840433e-18
2025-12-22 16:09:12 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:13 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.09707268580535326, 0.023791916323061477, 7.37257477290143e-18, 0.030513662938738854, 0.1307586767555667, 0.3781126958275823]
2025-12-22 16:09:13 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:14 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-22 16:09:14 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:15 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.009378238281431557 h(50)=0.030513662938738854 h(70)=0.19402493525727005
2025-12-22 16:09:15 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:15 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 16:09:16 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 16:09:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.142s
2025-12-22 16:09:16 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-22 16:09:16 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:17 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29448 K_raw=12 K_cent=10
2025-12-22 16:09:17 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=M, tau2_bar=0.000030
2025-12-22 16:09:17 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=F, tau2_bar=0.000248
2025-12-22 16:09:17 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=M, sigma2_reml=0.028492, tau2_bar=0.000030, sigma2_use=0.028462
2025-12-22 16:09:17 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=F, sigma2_reml=0.027064, tau2_bar=0.000248, sigma2_use=0.026816
2025-12-22 16:09:17 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:09:18 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar with missing references: OK (tau2_bar=0.0)
2025-12-22 16:10:12 | INFO     | root                 | === Логирование включено ===
2025-12-22 16:10:12 | INFO     | spline_model.spline_tests.test_real_data | Строим модель!
2025-12-22 16:10:12 | INFO     | MarathonAgeModel     | DataLoader class: DataLoader.data_loader.DataLoader
2025-12-22 16:10:12 | INFO     | MarathonAgeModel     | DataLoader file: C:\Users\andre\github\Marathons\DataLoader\data_loader.py
2025-12-22 16:10:12 | INFO     | MarathonAgeModel     | DataLoader OUTPUT_COLUMNS: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 16:10:12 | INFO     | MarathonAgeModel     | df columns: ['surname', 'name', 'race_id', 'year', 'gender', 'age', 'time_seconds', 'status', 'city', 'bib_number', 'distance_km']
2025-12-22 16:10:12 | INFO     | MarathonAgeModel     | load_data: rows 0 → 53142, elapsed 0.06s
2025-12-22 16:10:12 | INFO     | MarathonAgeModel     | filter_raw: rows 53142 → 42443, elapsed 0.02s
2025-12-22 16:10:12 | INFO     | MarathonAgeModel     | validate_raw: rows 42443 → 42443, elapsed 0.02s
2025-12-22 16:10:12 | INFO     | MarathonAgeModel     | add_row_id: rows 42443 → 42443, elapsed 0.01s
2025-12-22 16:10:13 | INFO     | utils.city_normalizer | dump_unrecognized_cities: dumped 200 cities to C:\Users\andre\github\Marathons\test_outputs\unrecognized_cities_top.txt (elapsed 0.005s)
2025-12-22 16:10:14 | INFO     | MarathonAgeModel     | preprocess: rows 42443 → 42355, elapsed 2.12s
2025-12-22 16:10:14 | INFO     | MarathonAgeModel     | build_train_frame_loy: rows 42355 → 36203, elapsed 0.07s, validation_year=2025
2025-12-22 16:10:14 | INFO     | MarathonAgeModel     | build_trace_references: rows 36203 → 10, elapsed 0.39s, groups=10
2025-12-22 16:10:26 | INFO     | MarathonAgeModel     | build_age_references: rows 36203 → 335, elapsed 0.46s, races=5
2025-12-22 16:10:26 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:26 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 16:10:27 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 16:10:27 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.050s
2025-12-22 16:10:27 | INFO     | MarathonAgeModel     | fit_age_model: rows 42355 → 36203, elapsed 1.09s, validation_year=2025
2025-12-22 16:10:27 | DEBUG    | spline_model.spline_tests.test_real_data | spline degree: 3
2025-12-22 16:10:27 | DEBUG    | spline_model.spline_tests.test_real_data | x_used_for_spline range: -1.7 4.5
2025-12-22 16:10:27 | DEBUG    | spline_model.spline_tests.test_real_data | knots_x range: -1.7 4.5
2025-12-22 16:10:27 | INFO     | spline_model.spline_tests.test_real_data | real_data build_raw_basis: shape=(36203, 12) elapsed_sec=0.005999088287353516
2025-12-22 16:10:27 | INFO     | spline_model.spline_tests.test_real_data | real_data partition_of_unity max_abs_err: 2.220446049250313e-16
2025-12-22 16:10:27 | INFO     | spline_model.spline_tests.test_real_data | real_data solve_penalized_lsq: rss=622529.0077779426 max_abs_constraint=4.440892098500626e-15
2025-12-22 16:10:27 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:28 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_gender: beta_len=12 max_abs_constraint=7.37257477290143e-18
2025-12-22 16:10:28 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:29 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:31 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:32 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h(age_center=35.0) = 7.15573433840433e-18
2025-12-22 16:10:32 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:33 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h: ages=[18.0, 25.0, 35.0, 50.0, 65.0, 80.0] h_values=[0.09707268580535326, 0.023791916323061477, 7.37257477290143e-18, 0.030513662938738854, 0.1307586767555667, 0.3781126958275823]
2025-12-22 16:10:33 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:34 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h clamp: OK
2025-12-22 16:10:34 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:35 | INFO     | spline_model.spline_tests.test_real_data | real_data predict_h shape: h(30)=0.009378238281431557 h(50)=0.030513662938738854 h(70)=0.19402493525727005
2025-12-22 16:10:35 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:35 | INFO     | spline_model.age_spline_fit | fit_gender: gender=M, n=29448
2025-12-22 16:10:36 | INFO     | spline_model.age_spline_fit | fit_gender: gender=F, n=6755
2025-12-22 16:10:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter.fit: completed genders=['M', 'F'] in 1.280s
2025-12-22 16:10:36 | INFO     | spline_model.spline_tests.test_real_data | real_data fit both genders: M_beta_len=12 F_beta_len=13
2025-12-22 16:10:36 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:38 | INFO     | spline_model.spline_tests.test_real_data | real_data fit_report: n=29448 K_raw=12 K_cent=10
2025-12-22 16:10:38 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=M, tau2_bar=0.000030
2025-12-22 16:10:38 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar: gender=F, tau2_bar=0.000248
2025-12-22 16:10:38 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=M, sigma2_reml=0.028492, tau2_bar=0.000030, sigma2_use=0.028462
2025-12-22 16:10:38 | INFO     | spline_model.spline_tests.test_real_data | real_data sigma2_use: gender=F, sigma2_reml=0.027064, tau2_bar=0.000248, sigma2_use=0.026816
2025-12-22 16:10:38 | INFO     | spline_model.age_spline_fit | AgeSplineFitter initialized: age_center=35.0, age_scale=10.0, degree=3, lambda_method=REML
2025-12-22 16:10:39 | INFO     | spline_model.spline_tests.test_real_data | real_data tau2_bar with missing references: OK (tau2_bar=0.0)
